<!DOCTYPE html>
<html>
  <head>
    <title>Merging Two Domains - alexn.org and bionicspirit.com</title>

    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="author" content="Alexandru Nedelcu">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    <link rel="image_src" href="/assets/images/picture_alex.jpg" />

    <link href="http://bionicspirit.com/rss" rel="alternate" title="Alexandru Nedelcu" type="application/atom+xml" />
    <link rel="shortcut icon" href="/assets/images/faviconred.ico" /> 
    <link rel="stylesheet" href="/assets/all.css?ck=d41d8cd98f00b204e9800998ecf8427e" type="text/css" media="screen, projection" />

    <link href="https://plus.google.com/112639155372207976835/" rel="publisher" />

    <!-- Google Analytics -->
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-27605864-1']);
    //_gaq.push(['_setDomainName', 'bionicspirit.com']);
    _gaq.push(['_trackPageview']);

    (function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </head>
  <body>

    <div id="header">
      <div class="wrapper">
	<a href="/">bionicspirit.com</a>
	<a class="extra" href="/pages/about.html" rel="author">about</a>
	<a class="extra" href="/pages/subscribe.html">subscribe</a>
	<a href="http://github.com/alexandru" class="github"><img src="/assets/images/fork.png" alt="Fork me on GitHub" /></a>
      </div>
    </div>
      
    <div class="site">
      <div id="post">
  <h1>Merging Two Domains - alexn.org and bionicspirit.com</h1>
  <div class="post-date">10 Jan 2012</div>

  <p>I apologize if your feed reader went rogue and flagged all articles as
being unread. I migrated <em>alexn.org</em> to a new domain name:
<em>bionicspirit.com</em>.</p>

<p><em>bionicspirit.com</em> was supposed to be a blog about Android-related
development, however I cannot focus on two blogs, one being a big
enough chore already. I also prefer <em>bionicspirit.com</em> because:</p>

<ul>
<li>it can be pronounced even over the phone, in English or in my native
language,</li>
<li>it is easier to remember, even if it is longer,</li>
<li>it is a dot-com.</li>
</ul>


<h2>301 Permanent Redirect</h2>

<p>I had to do a 301 Permanent Redirect for all requests, from
<em>alexn.org</em> to <em>bionicspirit.com</em>, without changing the path. This
keeps all links valid, keeps users happy and also keeps the Google
Juice flowing.</p>

<p>In case you don't have a smart DNS service, here's how to do it
cheaply, using Heroku (again):</p>

<div class="highlight"><pre><code class="bash"><span class="c"># new directory</span>
mkdir mydomain
<span class="c"># change to it</span>
<span class="nb">cd </span>mydomain

<span class="c"># initialize a git repository</span>
git init .
</code></pre>
</div>


<p>Then create a file called "<em>Gemfile</em>", for specifying dependencies:</p>

<div class="highlight"><pre><code class="ruby"><span class="n">source</span> <span class="s1">&#39;http://rubygems.org&#39;</span>

<span class="n">gem</span> <span class="s1">&#39;rack&#39;</span>

<span class="n">group</span> <span class="ss">:development</span> <span class="k">do</span>
  <span class="c1"># command line tools</span>
  <span class="n">gem</span> <span class="s1">&#39;heroku&#39;</span>
<span class="k">end</span>
</code></pre>
</div>


<p>Install these prerequisites (on the command-line again):</p>

<div class="highlight"><pre><code class="bash"><span class="c"># in case you don&#39;t already have Bundler installed:</span>
gem install bundler

<span class="c"># and then ...</span>
bundle install 
</code></pre>
</div>


<p>Create a Rack configuration file that handles your logic, called
"<em>config.ru</em>":</p>

<div class="highlight"><pre><code class="ruby"><span class="c1"># our Rack middleware</span>

<span class="k">class</span> <span class="nc">RedirectBetweenDomains</span>
  <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
    <span class="n">request</span> <span class="o">=</span> <span class="no">Rack</span><span class="o">::</span><span class="no">Request</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
    
    <span class="c1"># replacement logic here:</span>
    <span class="n">new_url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;alexn.org&quot;</span><span class="p">,</span> <span class="s2">&quot;bionicspirit.com&quot;</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;Location&quot;</span> <span class="o">=&gt;</span> <span class="n">new_url</span><span class="p">,</span> 
      
      <span class="c1"># permanent redirects could end up cached</span>
      <span class="s1">&#39;Cache-Control&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;no-cache&#39;</span><span class="p">,</span>
      
      <span class="c1"># not needed, but rack (env=development) complains</span>
      <span class="c1"># otherwise      </span>
      <span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;text/html&#39;</span><span class="p">,</span>
    <span class="p">}</span>    

    <span class="o">[</span><span class="mi">301</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="o">[]]</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">run</span> <span class="no">RedirectBetweenDomains</span><span class="o">.</span><span class="n">new</span>
</code></pre>
</div>


<p>Now deploy on Heroku (from the command line):</p>

<div class="highlight"><pre><code class="bash"><span class="c"># committing</span>
git add .
git commit -m <span class="s1">&#39;initial commit - rack config&#39;</span>

<span class="c"># creating heroku app</span>
heroku create

<span class="c"># renaming to something nicer</span>
heroku rename yourappid

<span class="c"># deploying on heroku</span>
git push heroku master
</code></pre>
</div>


<p>When it finishes, you can test the setup on
<em>http://yourappid.heroku.com</em> (where <em>rabbit</em> is your application's
name). Also checkout their article on
<a href="http://devcenter.heroku.com/articles/custom-domains">adding custom domains</a>.</p>

</div>

<div id="other-articles">
  <h2>Related Articles</h2>

  <ul class="posts">
    
      <li><span>05 Jan 2012</span> &raquo; <a href="/blog/2012/01/05/blogging-for-hackers.html">Blogging Platform for Hackers</a></li>
    
      <li><span>16 Dec 2011</span> &raquo; <a href="/blog/2011/12/16/ux-tip-dont-make-your-interface-us-centric.html">UX Tip: Don't Make Me Curse The Day I Decided To Sign-Up</a></li>
    
      <li><span>15 Dec 2011</span> &raquo; <a href="/blog/2011/12/15/crawling-the-android-marketplace-155200-apps.html">Crawling the Android Marketplace</a></li>
    
      <li><span>12 Dec 2011</span> &raquo; <a href="/blog/2011/12/12/ux-tip-outside-us-dont-require-postal-codes.html">UX Tip: Outside the US, Don't Require Postal Codes</a></li>
    
      <li><span>12 Dec 2011</span> &raquo; <a href="/blog/2011/12/12/android-learning-resources.html">Android Learning Resources</a></li>
    
  </ul>
</div>

<div id="contributions">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = 'alexnorg'; 

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


      
      <div class="footer">
	<div class="contact">
	  <p>
	    &copy; 2012 Alexandru Nedelcu
	    <br />
	    Some rights reserved (<a href="http://creativecommons.org/licenses/by-nc/3.0/" rel="license">CC BY-NC 3.0</a>)
	    <br />
	    <a href="mailto:&#099;&#111;&#110;&#116;&#097;&#099;&#116;&#064;&#098;&#105;&#111;&#110;&#105;&#099;&#115;&#112;&#105;&#114;&#105;&#116;&#046;&#099;&#111;&#109;">&#099;&#111;&#110;&#116;&#097;&#099;&#116;&#064;&#098;&#105;&#111;&#110;&#105;&#099;&#115;&#112;&#105;&#114;&#105;&#116;&#046;&#099;&#111;&#109;</a>
	  </p>
	</div>

	<div class="rss">
	  <a href="/rss" target="_blank" title="Subscribe to RSS Feed">
	    <img src="/assets/images/rss.png" alt="Subscribe to RSS Feed" />
	  </a>
	  <a href="/pages/subscribe.html" title="Subscribe to Newsletter">
	    <img src="/assets/images/email.png" alt="Subscribe to Newsletter" />
	  </a>
	  <a href="https://twitter.com/alex_ndc" target="_blank" title="Follow me on Twitter (@alex_ndc)">
	    <img src="/assets/images/twitter.png" alt="Follow me on Twitter (@alex_ndc)" />
	  </a>
	</div>
      </div>
    </div>
  </body>
</html>
