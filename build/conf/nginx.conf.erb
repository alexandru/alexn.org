worker_processes  4;
daemon off;

events {
    worker_connections  2048;
}

http {
    include       mime.types;
    default_type  application/octet-stream;
    sendfile      on;
    keepalive_timeout  30;

    gzip on;
    gzip_disable "msie6";
    gzip_vary on;
    gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript image/x-icon;

    server {
        listen       <%= ENV['PORT'] %>;
        server_name  bionicspirit.herokuapp.com www.bionicspirit.com;    

	rewrite ^(.*) https://bionicspirit.com$1 permanent;
    }

    server {
        listen       <%= ENV['PORT'] %>;
        server_name  bionicspirit.com;

        charset utf-8;

        location / {
            root   html;
            index  index.html index.htm;
     	    log_not_found off;

            rewrite  ^/rss/?$  https://www.bionicspirit.com/atom.xml permanent;
            rewrite ^/docs/dialer.html$ https://www.bionicspirit.com/blog/2009/02/20/tips-for-creating-voip-dialer.html permanent;
            rewrite  ^/TheBuzzEngine/?$  https://www.bionicspirit.com/projects/TheBuzzEngine/ permanent;
            rewrite  ^/crossdomain-requests-js/?$  https://www.bionicspirit.com/projects/crossdomain-requests-js/ permanent;
            rewrite  ^/ro.rss/?$  https://www.bionicspirit.com/rss permanent;
            rewrite  ^/blog/2011/10/26/a-fi-parinte-2.html$  http://aiuto.ro/blog/2011/10/26/a-fi-parinte-2.html permanent;
            rewrite  ^/blog/2011/10/25/a-fi-parinte-1.html$  http://aiuto.ro/blog/2011/10/25/a-fi-parinte-1.html permanent;

            expires 24h;
        }

	location /assets/ {
	    root html;
	    expires max;
     	    log_not_found off;
  	}

        error_page  404              /pages/404.html;
    }
}
