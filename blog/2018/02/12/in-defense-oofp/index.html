<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="color-scheme" content="light dark">
    <!--https://developers.google.com/web/fundamentals/design-and-ux/browser-customization-->
    <meta name="theme-color" content="#493667">
    
    <title>In Defense of OOFP - Alexandru Nedelcu</title>
    

    <!-- Open Graph Meta -->
    <meta content="Alexandru Nedelcu" property="og:site_name">
    <meta content="In Defense of OOFP" property="og:title">
    <meta content="OOP versus Type Classes, exemplified and in defense of the Scala collections redesign." property="og:description">
    <meta content="https://alexn.org/blog/2018/02/12/in-defense-oofp/" property="og:url">
    <meta content="2018-02-12T00:00:00+00:00" property="article:published_time">
    
    <meta property="og:type" content="article" />
    <meta property="og:image" content="https://alexn.org/assets/media/articles/scala-stairs.jpg?202209131235" />
    <meta property="og:image:secure_url" content="https://alexn.org/assets/media/articles/scala-stairs.jpg?202209131235" />
    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:src" content="https://alexn.org/assets/media/articles/scala-stairs.jpg?202209131235">
    <meta name="twitter:site" content="@alexelcu">
    <meta name="twitter:creator" content="@alexelcu">
    <meta name="twitter:title" content="In Defense of OOFP">
    <meta name="twitter:url" content="https://alexn.org/blog/2018/02/12/in-defense-oofp/">
    <meta name="twitter:description" content="OOP versus Type Classes, exemplified and in defense of the Scala collections redesign.">
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" sizes="48x48" />
    <link rel="icon" href="/assets/logo/16px.png" sizes="16x16" />
    <link rel="icon" href="/assets/logo/32px.png" sizes="32x32" />
    <link rel="icon" href="/assets/logo/192px.png" sizes="192x192" />
    <link rel="icon" href="/assets/logo/270px.png" sizes="270x270" />
    <link rel="icon" href="/assets/logo/512px.png" sizes="512x512" />
    <link rel="apple-touch-icon-precomposed" href="/assets/logo/180px.png" />
    <meta name="msapplication-TileImage" content="/assets/logo/270px.png" />

    <!-- Come and get me RSS readers -->
    <link rel="alternate" type="application/rss+xml" title="All articles (blog + wiki)" href="/feeds/all.xml" />
    <link rel="alternate" type="application/rss+xml" title="Blog" href="/feeds/blog.xml" />
    <link rel="alternate" type="application/rss+xml" title="Wiki" href="/feeds/wiki.xml" />

    <!-- Points at alexn.org, taking care of the search-engine indexing of mirrors: -->
    <link rel="canonical" href="https://alexn.org/blog/2018/02/12/in-defense-oofp/">
    
    <style type="text/css" media="all">
      /*! normalize.css v6.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:0.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{margin:0}button,input{overflow:visible}button,select{text-transform:none}button,html [type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}@font-face{font-family:'Fira Code';font-style:normal;font-weight:300;font-display:swap;src:url("/assets/fonts/fira-code-v8-latin-300.eot");src:local(""),url("/assets/fonts/fira-code-v8-latin-300.eot?#iefix") format("embedded-opentype"),url("/assets/fonts/fira-code-v8-latin-300.woff2") format("woff2"),url("/assets/fonts/fira-code-v8-latin-300.woff") format("woff"),url("/assets/fonts/fira-code-v8-latin-300.ttf") format("truetype"),url("/assets/fonts/fira-code-v8-latin-300.svg#FiraCode") format("svg")}@font-face{font-family:'Fira Code';font-style:normal;font-weight:500;font-display:swap;src:url("/assets/fonts/fira-code-v8-latin-500.eot");src:local(""),url("/assets/fonts/fira-code-v8-latin-500.eot?#iefix") format("embedded-opentype"),url("/assets/fonts/fira-code-v8-latin-500.woff2") format("woff2"),url("/assets/fonts/fira-code-v8-latin-500.woff") format("woff"),url("/assets/fonts/fira-code-v8-latin-500.ttf") format("truetype"),url("/assets/fonts/fira-code-v8-latin-500.svg#FiraCode") format("svg")}@font-face{font-family:'Fira Code';font-style:normal;font-weight:400;font-display:swap;src:url("/assets/fonts/fira-code-v8-latin-regular.eot");src:local(""),url("/assets/fonts/fira-code-v8-latin-regular.eot?#iefix") format("embedded-opentype"),url("/assets/fonts/fira-code-v8-latin-regular.woff2") format("woff2"),url("/assets/fonts/fira-code-v8-latin-regular.woff") format("woff"),url("/assets/fonts/fira-code-v8-latin-regular.ttf") format("truetype"),url("/assets/fonts/fira-code-v8-latin-regular.svg#FiraCode") format("svg")}@font-face{font-family:'Fira Code';font-style:normal;font-weight:600;font-display:swap;src:url("/assets/fonts/fira-code-v8-latin-600.eot");src:local(""),url("/assets/fonts/fira-code-v8-latin-600.eot?#iefix") format("embedded-opentype"),url("/assets/fonts/fira-code-v8-latin-600.woff2") format("woff2"),url("/assets/fonts/fira-code-v8-latin-600.woff") format("woff"),url("/assets/fonts/fira-code-v8-latin-600.ttf") format("truetype"),url("/assets/fonts/fira-code-v8-latin-600.svg#FiraCode") format("svg")}@font-face{font-family:'Fira Code';font-style:normal;font-weight:700;font-display:swap;src:url("/assets/fonts/fira-code-v8-latin-700.eot");src:local(""),url("/assets/fonts/fira-code-v8-latin-700.eot?#iefix") format("embedded-opentype"),url("/assets/fonts/fira-code-v8-latin-700.woff2") format("woff2"),url("/assets/fonts/fira-code-v8-latin-700.woff") format("woff"),url("/assets/fonts/fira-code-v8-latin-700.ttf") format("truetype"),url("/assets/fonts/fira-code-v8-latin-700.svg#FiraCode") format("svg")}body .intro{font-size:1.25em;line-height:1.7}h1,.h1,h2,.h2,h3,.h3,h4,.h4,h5,.h5,h6,.h6{margin:.5rem 0 1.5rem;font-family:"Gill Sans",Tahoma,Helvetica,Arial,sans-serif}h1,.h1{font-size:2em;line-height:1.25}@media (min-width: 43.75em){h1,.h1{font-size:2.5em;line-height:1.125}}@media (min-width: 56.25em){h1,.h1{font-size:3em;line-height:1.05}}h2,.h2{font-size:1.625em;line-height:1.15384615}@media (min-width: 43.75em){h2,.h2{font-size:2em;line-height:1.25}}@media (min-width: 56.25em){h2,.h2{font-size:2.25em;line-height:1.25}}h3,.h3{font-size:1.375em;line-height:1.13636364}@media (min-width: 43.75em){h3,.h3{font-size:1.5em;line-height:1.25}}@media (min-width: 56.25em){h3,.h3{font-size:1.75em;line-height:1.25}}h4,.h4{font-size:1.125em;line-height:1.11111111}@media (min-width: 43.75em){h4,.h4{line-height:1.22222222}}.button__outline,.button-tertiary,.button-secondary,.button{background-color:#00649e;display:inline-block;position:relative;font-family:"Gill Sans",Tahoma,Helvetica,Arial,sans-serif;text-decoration:none;color:#fff;font-size:1em;line-height:1.2em;font-weight:normal;padding:.5em 1.5em;border:0;border-radius:4px;cursor:pointer;margin-bottom:.5em;transition:background-color 0.14s ease-in-out}.button__outline:hover,.button-tertiary:hover,.button-secondary:hover,.button:hover,.button__outline:focus,.button-tertiary:focus,.button-secondary:focus,.button:focus{color:#fff;text-decoration:none;background-color:#00446b}.button__outline:active,.button-tertiary:active,.button-secondary:active,.button:active{top:1px}.button-secondary{background-color:#008bd8}.button-secondary:hover{background-color:#006aa5}.button-tertiary{background-color:#aaa}.button-tertiary:hover{background-color:#919191}.button__outline{background-color:transparent;border:3px solid #00649e;color:#00649e}.button__outline:hover{background-color:#00649e;color:#fff}label{display:block;margin-bottom:5px}input[type=text],input[type=email],input[type=phone],input[type=password],input[type=number],input[type=search],textarea{background:#e6e6e6;padding:5px;outline:none;border:none;height:44px;width:300px;margin-bottom:.5rem;font-size:100%}input[type=text]:focus,input[type=email]:focus,input[type=phone]:focus,input[type=password]:focus,input[type=number]:focus,input[type=search]:focus,textarea:focus{border:1px solid #00649e}input.full-width[type=text],input.full-width[type=email],input.full-width[type=phone],input.full-width[type=password],input.full-width[type=number],input.full-width[type=search],textarea.full-width{width:100%}textarea{height:132px}form{margin-bottom:40px}form .field{margin-bottom:20px}form label{color:#666}form .note-warning{margin-top:5px;color:#aaa}form .req{font-style:italic}form .asterisk{color:darkred}form .error .reason{margin-top:5px;color:#FF4136}form .error input[type=text],form .error input[type=email],form .error input[type=phone],form .error input[type=password],form .error input[type=number],form .error input[type=search],form .error textarea{border-color:#FF4136}table{width:100%;border:1px solid #d0d0d0;margin-bottom:1.5em}table caption{margin:0 0 7px;font-size:0.75em;color:#aaa;text-transform:uppercase;letter-spacing:1px}tr{border-bottom:1px solid #d0d0d0}tr:nth-child(even){background-color:#f7f7f7}td{padding:7px;border-right:1px solid #d0d0d0}td:last-child{border-right:0}th{background-color:#f7f7f7;border-bottom:1px solid #d0d0d0;border-right:1px solid #d0d0d0}th:last-child{border-right:0}.highlight{color:#333;background:#f0f0f0;white-space:pre;overflow:auto;word-wrap:normal;border:1px solid #bbb;border-radius:4px;padding:10px 0;line-height:1.3;font-size:.9em}code.highlighter-rouge{background-color:rgba(27,31,35,0.05);padding:.2em .4em;margin:0;font-size:85%;border-radius:3px}div.formula-code{color:#333;background:#f0f0f0;white-space:pre;overflow:auto;word-wrap:normal;border:1px solid #bbb;border-radius:4px;padding:10px 0;margin:0 0 20px 0}div.formula-code .MathJax_Display{margin:0 !important}.highlight .hll{background-color:#ffc}.highlight .c{color:#999}.highlight .err{color:#a00;background-color:#faa}.highlight .k{color:#069}.highlight .o{color:#555}.highlight .cm{color:#09f;font-style:italic}.highlight .cp{color:#099}.highlight .c1{color:#999}.highlight .cs{color:#999}.highlight .gd{background-color:#fcc;border:1px solid #c00}.highlight .ge{font-style:italic}.highlight .gr{color:#f00}.highlight .gh{color:#030}.highlight .gi{background-color:#cfc;border:1px solid #0c0}.highlight .go{color:#aaa}.highlight .gp{color:#009}.highlight .gu{color:#030}.highlight .gt{color:#9c6}.highlight .kc{color:#069}.highlight .kd{color:#069}.highlight .kn{color:#069}.highlight .kp{color:#069}.highlight .kr{color:#069}.highlight .kt{color:#078}.highlight .m{color:#f60}.highlight .s{color:#d44950}.highlight .na{color:#4f9fcf}.highlight .nb{color:#366}.highlight .nc{color:#0a8}.highlight .no{color:#360}.highlight .nd{color:#99f}.highlight .ni{color:#999}.highlight .ne{color:#c00}.highlight .nf{color:#c0f}.highlight .nl{color:#99f}.highlight .nn{color:#0cf}.highlight .nt{color:#2f6f9f}.highlight .nv{color:#033}.highlight .ow{color:#000}.highlight .w{color:#bbb}.highlight .mf{color:#f60}.highlight .mh{color:#f60}.highlight .mi{color:#f60}.highlight .mo{color:#f60}.highlight .sb{color:#c30}.highlight .sc{color:#c30}.highlight .sd{color:#c30;font-style:italic}.highlight .s2{color:#c30}.highlight .se{color:#c30}.highlight .sh{color:#c30}.highlight .si{color:#a00}.highlight .sx{color:#c30}.highlight .sr{color:#3aa}.highlight .s1{color:#c30}.highlight .ss{color:#fc3}.highlight .bp{color:#366}.highlight .vc{color:#033}.highlight .vg{color:#033}.highlight .vi{color:#033}.highlight .il{color:#f60}#isso-thread *{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}#isso-thread{padding:0;margin:0}h4.isso-thread-heading{color:#555;font-weight:bold}.isso-feedlink{float:right;padding-left:1em}.isso-feedlink a{font-size:0.8em;vertical-align:bottom}.isso-comment{max-width:68em;margin:0 auto}.isso-preview .isso-comment{padding-top:0;margin:0}.isso-comment:not(:first-of-type),.isso-follow-up .isso-comment{border-top:1px solid rgba(0,0,0,0.1);margin-bottom:0.5em}.isso-avatar{display:block;float:left;margin:0.95em 0.95em 0}.isso-avatar svg{max-width:48px;max-height:48px;width:100%;height:100%;border:1px solid rgba(0,0,0,0.2);border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,0.1)}.isso-text-wrapper{display:block;padding:0.95em}.isso-follow-up{padding-left:calc(7% + 20px)}.isso-comment-footer{font-size:0.95em}.isso-comment-header{font-size:0.85em}.isso-comment-header a{text-decoration:none}.isso-comment-header .isso-spacer{padding:0 6px}.isso-spacer,.isso-permalink,.isso-note,.isso-parent{color:gray;font-weight:normal;text-shadow:none}.isso-spacer:hover,.isso-permalink:hover,.isso-note:hover,.isso-parent:hover{color:#606060}.isso-note{float:right}.isso-author{font-weight:bold;color:#555}.isso-page-author-suffix{font-weight:bold;color:#2c2c2c}.isso-textarea,.isso-preview{margin-top:0.2em;width:100%;border:1px solid #f0f0f0;border-radius:2px;box-shadow:0 0 2px #888}.isso-text p{margin-top:0.2em}.isso-text p:last-child{margin-bottom:0.2em}.isso-text h1,.isso-text h2,.isso-text h3,.isso-text h4,.isso-text h5,.isso-text h6{font-size:130%;font-weight:bold}.isso-text pre{background:#eee;border:1px solid #ddd;padding:10px 15px;color:#4d4d4c;overflow:auto;line-height:1.5em}.isso-text :not(pre)>code{padding:.2em .4em;margin:0;font-size:85%;background-color:#eeeeee;border-radius:6px}.isso-comment-footer{font-size:0.80em;color:gray;clear:left}.isso-feedlink,.isso-comment-footer a{font-weight:bold;text-decoration:none}.isso-feedlink:hover,.isso-comment-footer a:hover{color:#111111;text-shadow:#aaaaaa 0 0 1px}.isso-comment-footer>a{position:relative;top:.2em}.isso-comment-footer>a+a{padding-left:1em}.isso-comment-footer .isso-votes{color:gray}.isso-upvote svg,.isso-downvote svg{position:relative;top:.2em}.isso-comment .isso-postbox{margin-top:0.8em}.isso-comment.isso-no-votes>*>.isso-comment-footer .isso-votes{display:none}.isso-postbox{max-width:68em;margin:0 auto 2em;clear:right}.isso-form-wrapper{display:block;padding:0}.isso-textarea,.isso-preview{margin:0 0 .3em;padding:.4em .8em;border-radius:3px;background-color:#fff;border:1px solid rgba(0,0,0,0.2);box-shadow:0 1px 2px rgba(0,0,0,0.1)}.isso-textarea{outline:0;width:100%;resize:none}.isso-form-wrapper input[type=checkbox]{vertical-align:middle;position:relative;bottom:1px;margin-left:0}.isso-notification-section{font-size:0.90em;padding-top:.3em;display:none;padding-bottom:10px}.isso-auth-section{display:block}.isso-textarea:focus,.isso-input-wrapper input:focus,.isso-auth-section input:focus{outline:2px solid #3584e4}.isso-input-wrapper{display:inline-block;position:relative;margin:0 1% 0 0}.isso-input-wrapper input{display:block;padding:.3em 10px;max-width:100%;border-radius:3px;background-color:#fff;line-height:1.4em;border:1px solid rgba(0,0,0,0.2);box-shadow:0 1px 2px rgba(0,0,0,0.1)}.isso-input-wrapper label{display:block;line-height:1.4em;height:1.4em}.isso-post-action{display:block;float:right;margin:1.4em 0 0 5px}.isso-post-action>input{padding:calc(.3em - 1px);border-radius:2px;border:1px solid #ccc;background-color:#ddd;cursor:pointer;outline:0;line-height:1.4em;box-shadow:0 1px 2px rgba(0,0,0,0.1)}.isso-post-action>input:hover{background-color:#ccc}.isso-post-action>input:active{background-color:#bbb}.isso-preview,.isso-post-action input[name="edit"],.isso-postbox.isso-preview-mode>.isso-form-wrapper input[name="preview"],.isso-postbox.isso-preview-mode>.isso-form-wrapper .isso-textarea{display:none}.isso-postbox.isso-preview-mode>.isso-form-wrapper .isso-preview{display:block}.isso-postbox.isso-preview-mode>.isso-form-wrapper input[name="edit"]{display:inline}.isso-preview{background-color:#f8f8f8;background:repeating-linear-gradient(-45deg, #f8f8f8, #f8f8f8 10px, #fff 10px, #fff 20px)}.isso-target{animation:isso-target-fade 5s ease-out}@keyframes isso-target-fade{0%{background-color:#eee5a1}}@media screen and (max-width: 600px){.isso-input-wrapper{display:block;max-width:100%;margin:0 0 .3em}.isso-input-wrapper input{width:100%}.isso-post-action{margin-top:0}}html.dark-reader body{background-image:none}html.dark-reader body .footer{background-image:none}html{box-sizing:border-box;background-color:#fefefe}*,*:before,*:after{box-sizing:inherit}body{background-color:#fff;background-image:url("/assets/media/tile-graphpaper.png");font-family:Georgia,Times,serif;line-height:1.75;font-size:112.5%;color:#111;overflow-x:hidden;margin:0}body p,body ul{margin:0 0 2rem}body code{font-family:"Fira Code",monospace,monospace;font-variant-ligatures:common-ligatures}::-moz-selection{background:#00649e;color:white}::selection{background:#00649e;color:white}img,video,audio,iframe,object{max-width:100%;height:auto}.container{max-width:610px;padding:0 20px;margin-left:auto;margin-right:auto}a{color:#00649e}a:hover{color:#003452}.nav-collapse{z-index:1}.nav-collapse ul{margin:0;padding:0;width:100%;display:block;list-style:none}.nav-collapse ul li{width:100%;display:block;background:#57457a;border-bottom:2px solid #675291}.nav-collapse ul li a{color:white;text-decoration:none;display:block;padding:5px 2rem}.nav-collapse{clip:rect(0 0 0 0);max-height:0;position:absolute;display:block;overflow:hidden;transform:scale(1);transform-origin:0 0;clear:both;width:100%}.no-js .nav-collapse{position:relative;max-height:none}.nav-collapse.opened{max-height:9999px}.nav-toggle{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;float:right;line-height:2em;margin-top:.5em;background-color:#00649e;border-radius:4px;padding:0 .5em;color:white;text-decoration:none;position:relative;right:2rem;transition:all 0.2s ease-in-out}.nav-toggle:hover{color:white;background-color:#00446b}.noList{list-style:none;padding-left:0;margin-left:0}dt{font-weight:bold}dd{margin:0 0 1.5rem}.post ul ul,.post ul ol,.post ol ul,.post ol ol{margin:0}.pageTitle{margin:2rem auto 1em;text-align:center}.pageTitle .type{color:#888}.content{padding-top:1em}.js .header{height:3em}.header{background-color:#473864;background-size:cover;background-position:center center;color:white;padding:0}.header .container{padding:0;max-width:100%}.header h1{margin:0;float:left;padding-left:2rem;font-size:1em;line-height:3em;font-family:"Gill Sans",Tahoma,Helvetica,Arial,sans-serif;text-transform:lowercase}.header h1 .wide1,.header h1 .wide2{display:none}.header h1 a{color:#e9d9ff;text-decoration:none;font-family:"Fira Code",monospace,monospace;font-variant-ligatures:common-ligatures;text-shadow:0px 0px 4px #000000}.post .postTitle{text-align:center;margin-top:2rem;margin-bottom:1rem}.post blockquote{color:#57606a;border-left:0.25em solid #d9d9d9}.post blockquote p{margin-left:2rem;width:100%}.post .meta,.post #article-details{text-align:center;color:gray;font-family:Georgia,Times,serif;font-weight:normal}.post .meta a,.post #article-details a{color:#1d8dcd;text-decoration:none}.post .meta a:hover,.post #article-details a:hover{text-decoration:underline}.post figure{margin:3rem 0}.post figure figcaption{text-align:center;font-size:.9em;font-style:italic;color:#5e5e5e}.post figure img{margin:0 auto;display:block}.post img{border-radius:3px}.post img.left{float:left;margin-right:1em;margin-bottom:1em}.post img.right{float:right;margin-left:1em;margin-bottom:1em}.post .highlight{clear:both;margin-bottom:2rem}.post .dropcap{color:#00649e;margin-right:.45rem}.post .featuredImage{position:relative;margin-top:2rem}.post .featuredImage img{margin-bottom:0}.post #article-details{border:0;border-top:2px solid #d9d9d9;width:100%;text-align:left;margin:0 auto;padding:1rem 0}.post #article-details #all-categories{margin-top:1rem;padding-top:1rem;border-top:1px solid #e6e6e6}.post .snippets ul{margin-top:1rem}.post .snippets ul li time{font-weight:normal;font-size:.9em;color:gray}.post hr{border-style:solid;border-color:#d9d9d9;border-width:1.5px 0 0 0;margin-top:2rem;margin-bottom:2rem}.post div.footnotes{font-size:85%}.post div.footnotes ol{margin:0;margin-bottom:2rem;width:100%;list-style-position:outside;padding-left:30px}.post div.footnotes li p{margin-left:0;margin-right:0;width:100%}.post.snippet .postTitle{font-size:100%}.post div.related{border-top:1.5px solid #d9d9d9}.post div.related,div.archive_list{width:100%;margin:0 auto}.post div.related h2,div.archive_list h2{margin:0;margin-top:1rem;color:#000}.post div.related div.container,div.archive_list div.container{display:block;margin-top:2rem}.post div.related div.container div.item,div.archive_list div.container div.item{clear:left;margin-bottom:1rem;width:100%}.post div.related div.container div.item div.related-image,div.archive_list div.container div.item div.related-image{display:block;float:right;margin-bottom:1rem;margin-left:1rem;width:42px;height:42px;background-position:center;background-repeat:no-repeat;background-size:cover;background-color:rgba(0,0,0,0.1);border-radius:2px;text-decoration:none;padding:1rem}.post div.related div.container div.item .related-meta,div.archive_list div.container div.item .related-meta{font-family:Georgia,Times,serif;font-weight:normal;font-size:.9em;color:gray;line-height:1.5}.post div.related div.container div.item .related-meta a,div.archive_list div.container div.item .related-meta a{color:#1d8dcd;text-decoration:none}.post div.related div.container div.item .related-meta a:hover,div.archive_list div.container div.item .related-meta a:hover{text-decoration:underline}div.archive_list{position:relative}div.archive_list h3{margin-top:4rem;color:#A66C75}div.archive_list:before{content:"";position:absolute;bottom:-2rem;left:0;background:#e6e6e6;height:2px;width:60px}div.archive_list.last:before{display:none}.postNav{border-top:1px solid #d9d9d9;border-bottom:1px solid #d9d9d9;overflow:hidden}.postNav .prev,.postNav .next{display:block;width:100%;height:5rem;overflow:hidden;position:relative;font-family:"Gill Sans",Tahoma,Helvetica,Arial,sans-serif;font-weight:800;font-size:.9em;text-transform:uppercase;text-align:center}.postNav .prev img,.postNav .next img{z-index:1;display:block;position:absolute;top:50%;transform:translateY(-50%);left:0;width:100%;height:auto}.postNav .prev span,.postNav .next span{z-index:10;position:relative;padding:.5rem;position:absolute;top:50%;transform:translateY(-50%);width:100%;line-height:1.4}.postNav .prev.image,.postNav .next.image{text-decoration:none;color:white;text-shadow:1px 1px 3px rgba(0,0,0,0.8);padding:0 .5rem;position:relative;transition:all 0.2s ease-in-out}.postNav .prev.image:hover,.postNav .next.image:hover{opacity:.8}.postNav .prev span{left:0}.postNav .next span{right:0}.footer{margin-top:2rem;clear:both;background:#fafafa}.footer hr{display:block;clear:both;border:1px solid #eaeaea;margin:1rem 0}.footer #footer-comments-widget{border-bottom:2px solid #eaeaea;margin-bottom:1rem}.footer .contributions{padding:1rem 0}.footer .contributions .note-warning{font-size:14px;border:1px solid #e1e4e8;background-color:#f6f8fa;border-radius:3px;padding:16px;font-family:-apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;margin-bottom:1rem}.footer .contributions .note-warning .extra{color:#586069}.footer .contributions #disqus_thread{max-width:90%;margin:0 auto;overflow:auto}.footer .contributions h2,.footer .contributions h3{margin-top:0;color:#A66C75}.footer .contributions #share{border-bottom:1px solid #C69AA1}.footer .contributions #isso-thread{font-size:90%}.footer .contributions #isso-thread .isso-comment>.isso-text-wrapper>div.isso-comment-header{display:inline-block;vertical-align:middle}.footer .contributions #isso-thread .isso-comment>.isso-text-wrapper>div.isso-text{clear:both}.footer .contributions #isso-thread .isso-comment>.isso-text-wrapper p{margin:0 0 0.7rem}.footer .contributions #isso-thread .isso-comment>.isso-text-wrapper blockquote{color:#777;margin:5px 0;padding:5px;padding-left:10px;border-left:4px solid #ddd;background-color:#f7f7f7}.footer .contributions #isso-thread .isso-comment>.isso-text-wrapper code{color:#333;background:#f0f0f0}.footer .contributions #isso-thread .isso-comment>.isso-text-wrapper pre{color:#333;background:#f0f0f0;white-space:pre;overflow:auto;word-wrap:normal;border:1px solid #bbb;border-radius:4px;padding:10px 0}.footer .contributions #isso-thread .isso-form-wrapper{font-size:90%}.footer .contributions #isso-thread .isso-textarea-wrapper textarea.isso-textarea{height:80px}.footer .contributions #isso-thread .isso-auth-section{font-size:90%}.footer .contributions #isso-thread .isso-auth-section .isso-input-wrapper{display:block}.footer .contributions #isso-thread .isso-auth-section .isso-input-wrapper input{width:100%;height:auto}.footer .contributions #isso-thread .isso-auth-section .isso-post-action{margin:0.5em 0px 0px 5px}.footer .contributions #isso-thread .isso-auth-section .isso-post-action input{padding:.2em 1em;border-radius:4px;border:0;margin-right:5px}.footer .contributions #isso-thread .isso-auth-section .isso-post-action input[type=submit]{background-color:#00649e;color:#fff;font-weight:bold;border:0;cursor:pointer}.footer .contributions #isso-thread .isso-auth-section .isso-post-action input[type=submit]:hover{color:white;background-color:#007bc2}.footer .contributions #isso-thread #isso-root{clear:both}.footer .contributions #isso-thread .isso-avatar img{max-width:24px;max-height:24px;border-radius:3px}.footer .contributions #mc_embed_signup form{margin-bottom:0}.footer .bottom{background:#f2f2f2;font-size:.8em;color:#656c7a;border-top:2px solid #eaeaea;border-bottom:2px solid #eaeaea;padding:1rem 0}.footer .bottom .container{max-width:90%;text-align:center}.footer .bottom .container .copy,.footer .bottom .container .links{display:block}.pagination div.page_number{color:gray;border-top:1px dashed #aaa;padding:1rem 0}.pagination .next{float:left}.pagination .previous{float:right}.posts li{margin-bottom:4rem;position:relative}.posts li:before{content:"";position:absolute;bottom:-2rem;left:0;background:#e6e6e6;height:2px;width:60px}.posts li:last-child:before{display:none}.posts li a{text-decoration:none}.posts li a:hover{text-decoration:underline}.posts li .meta{font-family:Georgia,Times,serif;font-weight:normal;font-size:.9em;color:gray}.posts li .meta time{display:block}.posts li .meta a{color:#1d8dcd;text-decoration:none}.posts li .meta a:hover{text-decoration:underline}.posts li h3{margin:0 0 .5em}#home{padding-top:2em}#home .postTitle{text-align:center}img.right{float:none}.patreon-button img{width:170px;height:40px}.post.about img.avatar{width:100px}.small-note{font-size:80%;color:gray}.video .youtube-play-link{position:relative;display:block;box-shadow:0px 0px 5px 0px rgba(50,50,50,0.3);border-radius:3px}.video .youtube-play-link:before{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);-webkit-transform:translate(-50%, -50%);display:block;width:80px;height:56px;font-size:1px;content:" ";opacity:.8;z-index:100;background-image:url(/assets/media/youtube.png);background-size:80px 56px;background-position:center;background-repeat:no-repeat;transition-timing-function:ease-in;transition:opacity 0.3s}.video .youtube-play-link:hover:before{opacity:1}.video .youtube-play-link img.play-thumb{display:block;min-height:70px}.video .video-container{position:relative;padding-bottom:56.25%;padding-top:10px;height:0;overflow:hidden}.video .video-container iframe,.video .video-container object,.video .video-container embed{position:absolute;top:0;left:0;width:100%;height:100%}.no-js .only-js{display:none}.no-js .video .video-container{display:none}.posts img{border-radius:3px}.posts figure{margin:1rem 0}.posts figure figcaption{text-align:center;font-size:.9em;font-style:italic;color:#5e5e5e}.posts figure img{margin:0 auto;display:block}.hidden{display:none}.post header nav.toc{border-top:1px solid #d9d9d9;border-bottom:1px solid #d9d9d9;margin-bottom:1rem}.post header nav.toc ul{margin-bottom:1rem}.post header nav.toc .toc-title{font-weight:bold;margin:1rem auto 1rem}.post .warn-bubble,.post .info-bubble,.post.privacy_policy #opt_out_frame iframe{background-color:rgba(226,231,240,0.3);color:#555;padding:7px;border:2px dashed #e2f0e7;border-radius:10px}.post .warn-bubble{color:#655;background-color:rgba(243,235,237,0.3);border:2px dashed #f6ddd7}.post .highlight{line-height:1.2;border-radius:0}.post .highlight pre.code{margin:0 auto;padding:0 5px;width:100%}.post .formula-code,.post .highlight>pre.code>code{font-size:90%}.post.privacy_policy #opt_out_frame iframe{width:100%;height:300px}h1,h2,h3,h4,h5,h6{color:#111;font-weight:700}h1 a.anchor,h2 a.anchor,h3 a.anchor,h4 a.anchor,h5 a.anchor,h6 a.anchor{color:lightgray;font-weight:normal;text-decoration:none}h1 a.anchor:hover,h2 a.anchor:hover,h3 a.anchor:hover,h4 a.anchor:hover,h5 a.anchor:hover,h6 a.anchor:hover{color:gray}.nobr{white-space:nowrap}.clearfix{transform:scale(1);transform-origin:0 0}.clearfix:before,.clearfix:after{content:"\0020";display:block;height:0;overflow:hidden}.clearfix:after{clear:both}@media only screen and (min-width: 375px){.header h1 .wide1{display:inline}}@media only screen and (min-width: 500px){.header h1 .wide1,.header h1 .wide2{display:inline}.post.privacy_policy #opt_out_frame iframe{height:260px}}@media only screen and (min-width: 800px){body{font-size:125%}.content{padding-top:0;position:relative;z-index:1}.container{max-width:880px;margin-left:auto;margin-right:auto;padding:0}#home .posts,#home .pageTitle,#home .pagination,#home .archive_list{width:75%;float:none;margin:0 auto 1.5em}#home .pageTitle{margin:2rem auto 1em}.js .header,.no-js .header{height:7em;position:relative;padding-bottom:0}.js .header .wide1,.js .header .wide2,.no-js .header .wide1,.no-js .header .wide2{display:inline}.js .header .container,.no-js .header .container{position:relative;top:50%;transform:translateY(-50%);max-width:880px;overflow:hidden}.js .header .container .inner-container,.no-js .header .container .inner-container{width:75%;margin:0 auto}.js .header h1,.no-js .header h1{font-size:2em;line-height:1;padding-left:0}.js .header nav,.no-js .header nav{float:left;clear:left}.js .header nav ul,.no-js .header nav ul{margin:0}.js .header nav ul li,.no-js .header nav ul li{display:inline;line-height:3em;background:none;padding:0 5px;border:none}.js .header nav ul li a,.no-js .header nav ul li a{color:white;font-size:0.9em;text-decoration:none;padding:0 0.25em}.js .header nav ul li a:hover,.no-js .header nav ul li a:hover{color:#ccc}.js .header nav ul li.current,.no-js .header nav ul li.current{padding-bottom:0.25em;border-bottom:4px solid rgba(255,255,255,0.4)}.nav-collapse{position:relative;max-height:none}.nav-collapse.closed{max-height:none}.nav-collapse ul li a{display:inline-block}.nav-toggle{display:none}.post h1,.post h2,.post h3,.post h4,.post h5,.post h6,.post p,.post ul,.post ol,.post dl,.post .pageTitle,.post .content,.post .page-width,.post blockquote,.post div.footnotes{width:75%;float:none;margin:0 auto 2rem}.post hr{width:75%}.post div.footnotes{margin:0 auto 1rem}.post div.footnotes p{margin-bottom:1rem}.post h1,.post .h1,.post h2,.post .h2,.post h3,.post .h3,.post h4,.post .h4,.post h5,.post .h5,.post h6,.post .h6{margin:1rem auto}.post .pageTitle{margin:2rem auto 1em}.post .featuredImage{position:relative;margin-top:2rem}.post .highlight{font-size:0.8em;padding:20px}.post div.formula-code{padding:20px 10px}.post blockquote{padding:0}.post.snippet .postTitle{font-size:120%}.postNav .prev,.postNav .next{width:50%}.postNav .prev{float:left;text-align:left}.postNav .next{text-align:right;float:right}.footer .container{max-width:880px}.footer .contributions{width:75%;margin:0 auto}.footer .contributions .avatar img{max-width:48px;max-height:48px;border-radius:5px}.footer .contributions #isso-thread .isso-avatar img{max-width:32px;max-height:32px}.footer .bottom .container .copy::after{content:"|"}.footer .bottom .container .copy,.footer .bottom .container .links{display:inline}.contactContent{max-width:48%;margin-right:2%;float:left}#contact form{max-width:48%;width:48%;float:right;margin-right:0}img.right{float:right}.post.about img.avatar{width:300px}div.header nav{text-shadow:0px 0px 4px #000000}#abonament form{width:75%;margin:0 auto 2rem}.post div.related{width:75%}.post #article-details{width:75%}.post .formula-code,.post .highlight>pre.code>code{font-size:100%}.post.privacy_policy #opt_out_frame iframe{height:190px}.video .youtube-play-link:before{width:120px;height:84px;background-size:120px 84px}}@media only screen and (min-width: 1200px){body{font-size:137.5%}.container{max-width:990px}.container .inner-container{width:75%;margin:0 auto}.js .header .container,.no-js .header .container{max-width:990px}.post .formula-code,.post .highlight>pre.code>code{font-size:110%}.post.privacy_policy #opt_out_frame iframe{height:180px}.footer .container{max-width:990px}.post.snippet .postTitle{font-size:140%}}@media (prefers-color-scheme: dark){:root{color-scheme:light dark}html,body,*{scrollbar-width:thin;scrollbar-color:#727173 #1e2223}body::-webkit-scrollbar,*::-webkit-scrollbar{width:10px}body::-webkit-scrollbar-track,*::-webkit-scrollbar-track{background:#1e2223}body::-webkit-scrollbar-thumb,*::-webkit-scrollbar-thumb{background-color:#727173;border-radius:6px;border:3px solid #1e2223}html{background-color:#171a1b;background-image:none}body{background-color:#171a1b;background-image:none;color:#c8d1d8}body a{color:#00c1ff}body a:hover{color:#0087b3}body .header{background-color:#473864}body h1,body h2,body h3,body h4,body h5,body h6{color:#dddad6}body .highlight{background:#11202c;color:#fefffe;border:1px solid #333}body div.formula-code{background:#11202c;color:#fefffe;border:1px solid #333}body code.language-plaintext.highlighter-rouge{background-color:#1e2325}body form label{color:#777}body form select,body form input,body form textarea,body form button,body form .textarea,body form input[type="text"],body form input[type="email"],body form input[type="phone"],body form input[type="password"],body form input[type="number"],body form input[type="search"]{border:1px solid #1a1a1a;color:#afafaf;background:#242424;transition:background-color 0.3s cubic-bezier(0.57, 0.21, 0.69, 1.25), transform 0.3s cubic-bezier(0.57, 0.21, 0.69, 1.25)}body form button,body form input[type="submit"],body form input[type="button"],body form input[type="reset"]{border:1px solid #262626;background:#333}body form ::placeholder{color:inherit;opacity:1}body .post header nav.toc{border-color:#2f363c}body .post .info-bubble{background-color:#25313c;border-color:#384b5c;color:#c8d1d8}body .post .info-bubble code.language-plaintext.highlighter-rouge{background-color:#2f3e4c}body .post .warn-bubble{background-color:#362521;border-color:#563b34;color:inherit}body .post .warn-bubble code.language-plaintext.highlighter-rouge{background-color:#46302b}body .post hr{border-color:#2f363c}body .post #article-details{border-color:#2f363c}body .post #article-details #all-categories{border-color:#2f363c}body .post div.related{border-color:#2f363c}body .post .meta,body .post #article-details{color:#778899}body .post .dropcap{color:#00c1ff}body .post blockquote{color:#8b949d;border-left-color:#2f363c}body .post .transparency-fix{background-color:#6f8288}body .button-secondary{background-color:#0ca8ff}body .button-secondary:hover{background-color:#008bd8}body a.button__outline{border:3px solid #00c1ff;color:#00c1ff}body a.button__outline:hover{background-color:#00c1ff;color:#fff}body .post div.related div.container div.item .related-meta,body div.archive_list div.container div.item .related-meta{color:#778899}body .post div.related h2,body div.archive_list h2{color:#dddad6}body .footer{background-color:#232729;background-image:none}body .footer .contributions #isso-thread label{color:#777}body .footer .contributions #isso-thread select,body .footer .contributions #isso-thread input,body .footer .contributions #isso-thread textarea,body .footer .contributions #isso-thread button,body .footer .contributions #isso-thread .textarea,body .footer .contributions #isso-thread input[type="text"],body .footer .contributions #isso-thread input[type="email"],body .footer .contributions #isso-thread input[type="phone"],body .footer .contributions #isso-thread input[type="password"],body .footer .contributions #isso-thread input[type="number"],body .footer .contributions #isso-thread input[type="search"]{border:1px solid #1a1a1a;color:#afafaf;background:#242424;transition:background-color 0.3s cubic-bezier(0.57, 0.21, 0.69, 1.25), transform 0.3s cubic-bezier(0.57, 0.21, 0.69, 1.25)}body .footer .contributions #isso-thread button,body .footer .contributions #isso-thread input[type="submit"],body .footer .contributions #isso-thread input[type="button"],body .footer .contributions #isso-thread input[type="reset"]{border:1px solid #262626;background:#333}body .footer .contributions #isso-thread ::placeholder{color:inherit;opacity:1}body .footer .contributions #isso-thread>h4{color:#8695a4}body .footer .contributions #isso-thread .isso-comment>div.isso-text-wrapper>.isso-comment-header{color:#778899}body .footer .contributions #isso-thread .isso-comment>div.isso-text-wrapper>.isso-comment-header .author{color:#8695a4}body .footer .contributions #isso-thread .isso-comment>.isso-text-wrapper blockquote{border-left-color:#3a3e41;background-color:#1d1f20;color:#9d9488}body .footer .contributions #isso-thread .isso-comment>.isso-text-wrapper code{background:#11202c;color:#fefffe}body .footer .contributions #isso-thread .isso-comment>.isso-text-wrapper pre{background:#11202c;color:#fefffe;border:1px solid #333}body .footer .contributions .note-warning{border:1px solid #171a1b;background-color:#1e2223}body .footer .contributions .note-warning .extra{color:#586069}body .footer .bottom{background:#171a1b;color:lightslategray;border-top:2px solid #232729;border-bottom:2px solid #232729}body .footer #footer-comments-widget{border-bottom:2px solid #464f52}body div.archive_list:before,body .posts li:before{background:#3a4244}.video .youtube-play-link{box-shadow:0px 0px 5px 0px rgba(200,200,200,0.3)}.highlight .c{color:#75715e}.highlight .err{color:#960050;background-color:#1e0010}.highlight .k{color:#66d9ef}.highlight .l{color:#ae81ff}.highlight .n{color:#f8f8f2}.highlight .o{color:#f92672}.highlight .p{color:#f8f8f2}.highlight .cm{color:#75715e}.highlight .cp{color:#75715e}.highlight .c1{color:#75715e}.highlight .cs{color:#75715e}.highlight .ge{font-style:italic}.highlight .gs{font-weight:bold}.highlight .kc{color:#66d9ef}.highlight .kd{color:#66d9ef}.highlight .kn{color:#f92672}.highlight .kp{color:#66d9ef}.highlight .kr{color:#66d9ef}.highlight .kt{color:#66d9ef}.highlight .ld{color:#e6db74}.highlight .m{color:#ae81ff}.highlight .s{color:#e6db74}.highlight .na{color:#a6e22e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#a6e22e}.highlight .no{color:#66d9ef}.highlight .nd{color:#a6e22e}.highlight .ni{color:#f8f8f2}.highlight .ne{color:#a6e22e}.highlight .nf{color:#a6e22e}.highlight .nl{color:#f8f8f2}.highlight .nn{color:#f8f8f2}.highlight .nx{color:#a6e22e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f92672}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f92672}.highlight .w{color:#f8f8f2}.highlight .mf{color:#ae81ff}.highlight .mh{color:#ae81ff}.highlight .mi{color:#ae81ff}.highlight .mo{color:#ae81ff}.highlight .sb{color:#e6db74}.highlight .sc{color:#e6db74}.highlight .sd{color:#e6db74}.highlight .s2{color:#e6db74}.highlight .se{color:#ae81ff}.highlight .sh{color:#e6db74}.highlight .si{color:#e6db74}.highlight .sx{color:#e6db74}.highlight .sr{color:#e6db74}.highlight .s1{color:#e6db74}.highlight .ss{color:#e6db74}.highlight .bp{color:#f8f8f2}.highlight .vc{color:#f8f8f2}.highlight .vg{color:#f8f8f2}.highlight .vi{color:#f8f8f2}.highlight .il{color:#ae81ff}.highlight .gu{color:#75715e}.highlight .gd{color:#f92672}.highlight .gi{color:#a6e22e}}

    </style>
</head>


<body>
   <div class="header">
  <div class="container">
    <div class="inner-container">
      <h1 class="logo"><a href="/">Alex<span class="wide2">andru</span> Nedelcu<span class="wide1"> =&lt;&lt;</span></a></h1>
      <nav class="nav-collapse">
        <ul class="noList">
          
          <li class="element first current ">
            <a href="/blog/">Blog</a>
          </li>
          
          <li class="element   ">
            <a href="/wiki/">Wiki</a>
          </li>
          
          <li class="element   ">
            <a href="/about/">About</a>
          </li>
          
          <li class="element   last">
            <a href="/subscribe/">Subscribe</a>
          </li>
          
        </ul>
      </nav>  
    </div>
  </div>
</div><!-- end .header -->


   <div class="content">
      <div class="container">
         <article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header>
      <h1 class="postTitle" itemprop="headline">
        
        
          
      In Defense of OOFP
    
        
        
      </h1>
    
    <p class="meta">
      <meta itemscope itemprop="mainEntityOfPage"  itemType="https://schema.org/WebPage" itemid="https://alexn.org/blog/2018/02/12/in-defense-oofp/"/>
      <meta itemprop="datePublished" content="2018-02-12T00:00:00+0000"/>
      
      <time itemprop="dateCreated" datetime="2018-02-12T00:00:00+0000">February 12, 2018</time>
      | <span class="nobr"><span class="time">33</span> minutes</span>
      
      | <a href="/blog/2018/02/12/in-defense-oofp/#isso-thread" class="nobr">comments</a>
      
    </p>

    
        <figure class="featuredImage" itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
          <meta itemprop="url" content="https://alexn.org/assets/media/articles/scala-stairs.jpg" />
          <img src="/assets/media/articles/scala-stairs.jpg?202209131235" width="1200" height="1200" alt="" />
          
        </figure>
        
    

    <div class="hidden" itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
      <meta itemprop="name" content="Alexandru Nedelcu">
      <meta itemprop="url" content="https://alexn.org/about/">
      <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
        <meta itemprop="url" content="https://alexn.org/assets/raw/logo-green.png">
      </div>
    </div>
    <div class="hidden" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <meta itemprop="name" content="Alexandru Nedelcu" />
        <meta itemprop="url" content="https://alexn.org/about/#alexelcu" />
        <meta itemprop="url" content="https://twitter.com/alexelcu" />
        <meta itemprop="url" content="https://github.com/alexandru" />
      </div>
    

    
    
    
    <nav class="toc">
      <p class="toc-title">Table of Contents:</p>
      <ul>
  <li><a href="#1-background">1. Background</a>
    <ul>
      <li><a href="#11-my-road-to-scala">1.1. My Road to Scala</a></li>
    </ul>
  </li>
  <li><a href="#2-criticism">2. Criticism</a>
    <ul>
      <li><a href="#21-canbuildfrom">2.1. CanBuildFrom</a></li>
      <li><a href="#22-complex-hierarchy">2.2. Complex Hierarchy</a></li>
      <li><a href="#23-seq-or-other-super-types">2.3. Seq or Other Super-types</a></li>
      <li><a href="#24-not-using-type-classes">2.4. Not Using Type-classes</a></li>
    </ul>
  </li>
  <li><a href="#3-oop-vs-constrained-parametric-polymorphism-type-classes">3. OOP vs Constrained Parametric Polymorphism (Type-classes)</a>
    <ul>
      <li><a href="#4-case-study-monix-iterant">4. Case Study: Monix Iterant</a></li>
      <li><a href="#41-type-classes-for-super-powers">4.1. Type-classes For Super Powers</a></li>
      <li><a href="#42-liskov-substitution-principle-oop-strikes-back">4.2. Liskov Substitution Principle: OOP Strikes Back</a></li>
      <li><a href="#43-iterator-vs-foldable-and-traverse">4.3. Iterator vs Foldable and Traverse</a></li>
    </ul>
  </li>
  <li><a href="#5-seq-my-love">5. Seq My Love</a>
    <ul>
      <li><a href="#51-seq-on-return">5.1. Seq on Return</a></li>
      <li><a href="#52-seq-on-input">5.2. Seq on Input</a></li>
    </ul>
  </li>
  <li><a href="#6-conclusion">6. Conclusion</a></li>
</ul>
    </nav>
    </header>

  <div id="content" itemprop="articleBody">
    <p class="intro withcap">
  This article is about OOP hierarchies, in comparisson with
  <a href="https://en.wikipedia.org/wiki/Type_class">type classes</a>, using as
  example Scala’s standard collections, which are involved in a recent
  debate around their redesign.
</p>
      <h2 id="1-background">
        
        
          1. Background <a href="#1-background" class="anchor">#</a>
        
        
      </h2>
    

<p>Scala is a hybrid language, being at the same time its greatest
strength and weakness.</p>

<p>The
<a href="https://github.com/scala/collection-strawman">collection-strawman</a>
represents a redesign of Scala’s standard collections, planned to be
shipped in Scala 2.13, as part of a
<a href="https://github.com/scalacenter/advisoryboard/blob/master/proposals/007-collections.md">Scala Center proposal</a>.</p>

<p>There are at the moment of writing two blog posts explaining the
upcoming changes on Scala’s blog:</p>

<ol>
  <li><a href="http://scala-lang.org/blog/2017/05/30/tribulations-canbuildfrom.html">Tribulations of CanBuildFrom</a></li>
  <li><a href="http://scala-lang.org//blog/2017/11/28/view-based-collections.html">Let Them Be Lazy!</a></li>
  <li><a href="http://www.scala-lang.org/blog/2017/02/28/collections-rework.html">Scala 2.13 Collections Rework</a></li>
  <li><a href="http://www.scala-lang.org/blog/2018/02/09/collections-performance.html">On Performance of the New Collections</a></li>
</ol>

<p>It’s now also receiving some criticism. This article represents my
2¢ on why I like this redesign and on why criticism of an
OOP hierarchy are not warranted, even if you love FP.</p>
      <h3 id="11-my-road-to-scala">
        
        
          1.1. My Road to Scala <a href="#11-my-road-to-scala" class="anchor">#</a>
        
        
      </h3>
    

<p>Like many others in the Scala community, I was attracted to Scala because
it seemed to be a better, more expressive language, with stricter
static type checks than Java or the other languages I worked
with. Coming from Python at that time, Scala seemed like a breath of
fresh air.</p>

<p>Yes, I came to Scala in 2012 looking for a better OOP language and
what I got was a great combination of Smalltalk-esque OOP features,
mixed with an
<a href="/blog/2017/10/15/functional-programming/">actual FP culturre</a>. I
have an article about
<a href="/blog/2012/11/02/scala-functional-programming-type-classes/">what I liked about it</a>
written back then and to be honest, not much has changed.</p>

<p>But what really sold me were the standard collections. In spite of their
internal complexity and problems being leaked at the call sites, it
was the first time I felt my needs for standard data structures were
met and even exceeded.</p>
      <h2 id="2-criticism">
        
        
          2. Criticism <a href="#2-criticism" class="anchor">#</a>
        
        
      </h2>
    

<p>There’s plenty to complain about in the current implementation and
here I’m doing my best to summarize it:</p>
      <h3 id="21-canbuildfrom">
        
        
          2.1. CanBuildFrom <a href="#21-canbuildfrom" class="anchor">#</a>
        
        
      </h3>
    

<p>Checkout this classic StackOverflow issue:</p>

<p><a href="https://stackoverflow.com/questions/1722726/is-the-scala-2-8-collections-library-a-case-of-the-longest-suicide-note-in-hist">Is the Scala 2.8 collections library a case of “the longest suicide note in history”?</a></p>

<p>In it the author rightfully complains that this method signature for
<code class="language-plaintext highlighter-rouge">List</code> is scary and he doesn’t understand it:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">def</span> <span class="nf">map</span><span class="o">[</span><span class="kt">B</span>, <span class="kt">That</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">B</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">bf</span><span class="k">:</span> <span class="kt">CanBuildFrom</span><span class="o">[</span><span class="kt">Repr</span>, <span class="kt">B</span>, <span class="kt">That</span><span class="o">])</span><span class="k">:</span> <span class="kt">That</span>
</code></pre></div></div>

<p>The Scala core developers first tried to hide this signature, so if
you’ll take a look at the
<a href="https://www.scala-lang.org/api/current/scala/collection/immutable/List.html#map[B](f:A=%3EB):List[B]">current ScalaDoc for List.map</a>,
you won’t see it. But that’s only a documentation trick, because
the actual source-code (and your IDE) tells a different story, see
<a href="https://github.com/scala/scala/blob/v2.12.4/src/library/scala/collection/immutable/List.scala#L280">List.scala#280</a>.</p>

<p>In essence <code class="language-plaintext highlighter-rouge">CanBuildFrom</code> is a clever abstraction, as
<a href="https://stackoverflow.com/a/1728140/3280">Martin Odersky</a> himself
explains, however at this point we can all agree that its complexity
is not justified. Not only because it is difficult to understand, but
because it has historically created issues for people at the call-sites.</p>

<p>Here’s what Coda Hale <a href="https://gist.github.com/anonymous/1406238">was writing</a>
back in 2011:</p>

<blockquote>
  <p><em>“
    Replacing a `scala.collection.mutable.HashMap` with a
    `java.util.HashMap` in a wrapper produced an order-of-magnitude
    performance benefit for one of these loops. Again, this led to some
    heinous code as any of its methods which took a `Builder` or
    `CanBuildFrom` would immediately land us with a mutable.HashMap. (We
    ended up using explicit external iterators and a while-loop, too.)    
    <br />...<br />
    The number of concepts I had to explain to new members of our team
    for even the simplest usage of a collection was surprising: implicit
    parameters, builder typeclasses, "operator overloading", return type
    inference, etc. etc.
  ”</em></p>
  <footer>
    <p>
      <a href="https://gist.github.com/anonymous/1406238">Source</a>
    </p>
  </footer>
</blockquote>

<p>But if you’ll take a look at
<a href="https://github.com/scala/collection-strawman/blob/master/collections/src/main/scala/strawman/collection/immutable/List.scala#L214">List.scala in collection-strawman</a>,
that signature now looks like this:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">def</span> <span class="nf">map</span><span class="o">[</span><span class="kt">B</span><span class="o">](</span><span class="n">f</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">B</span><span class="o">)</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span>
</code></pre></div></div>

<p>There, that brings justice to everybody that complained for all these
years.</p>

<p class="info-bubble">
<b><u>TL;DR</u></b>: <code class="language-plaintext highlighter-rouge">CanBuildFrom</code> was a clever solution to an exaggerated
problem, but you’ll no longer have to worry about it. Beware of clever
solutions to problems you don’t have!
</p>
      <h3 id="22-complex-hierarchy">
        
        
          2.2. Complex Hierarchy <a href="#22-complex-hierarchy" class="anchor">#</a>
        
        
      </h3>
    

<p>This is an awesome infographic, showing how complex the implementation is for
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/immutable/List.html">List</a>,
by <a href="https://github.com/tpolecat">Rob Norris</a>:</p>

<figure>
  <img src="/assets/media/articles/scala-list.jpg" width="1650" height="1275" />
</figure>

<p>This is indeed a disaster, there’s no nicer way of saying it.</p>

<p>And this is <code class="language-plaintext highlighter-rouge">List</code>, after the <code class="language-plaintext highlighter-rouge">collection-strawman</code> refactoring:</p>

<figure>
  <img src="/assets/media/articles/scala-list-strawman.jpg" width="1200" height="845" />
</figure>

<p>(Again credit goes to Rob Norris)</p>

<p>This is indeed vastly simplified and actually understandable.</p>

<p>Some questions are left to be answered. Just by looking at this
info-graphic I wonder in what capacity is there still code sharing
between the immutable collections and the mutable versions, or between
the lazy and the strict - ideally there should be no code sharing
between mutable or immutable, between lazy and strict and I hope
they’ve been extra careful this time around.</p>

<p class="info-bubble">
<b><u>TL;DR</u></b>: a complex OOP hierarchy, as clever as it may be,
brings with it complexity beyond reason and is counter-productive for
subtype polymorphism!
</p>
      <h3 id="23-seq-or-other-super-types">
        
        
          2.3. Seq or Other Super-types <a href="#23-seq-or-other-super-types" class="anchor">#</a>
        
        
      </h3>
    

<p><a href="https://github.com/djspiewak">Daniel Spiewak</a> made a good attempt at a
<a href="https://gist.github.com/djspiewak/2ae2570c8856037a7738">proposal in 2015</a>.</p>

<p>Here are some recent impressions, as a short introduction to this
criticism:</p>

<blockquote>
  <p><em>“
    You always care about the asymptotic properties of your data
    structures. So there is never a case where Seq makes sense, even as
    a concept!    
  ”</em></p>
  <footer>
    <p>
      <a href="https://twitter.com/djspiewak/status/962767948774457344" target="_blank">Source</a>      
    </p>
  </footer>
</blockquote>

<p>The example that Daniel gives in his proposal is this:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">def</span> <span class="nf">foo</span><span class="o">(</span><span class="n">is</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">MyThingy</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">t</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">MyThingy</span>
  <span class="nf">for</span> <span class="o">(</span><span class="n">idx</span> <span class="k">&lt;-</span> <span class="mi">0</span> <span class="n">until</span> <span class="nv">is</span><span class="o">.</span><span class="py">length</span><span class="o">)</span> <span class="o">{</span>
    <span class="nv">t</span><span class="o">.</span><span class="py">accumulate</span><span class="o">(</span><span class="nf">is</span><span class="o">(</span><span class="n">idx</span><span class="o">))</span>
  <span class="o">}</span>
  <span class="n">t</span>
<span class="o">}</span>
</code></pre></div></div>

<blockquote>
  <p><em>“If I showed you this code and asked you what the big-O complexity of
it was, could you tell me the answer? No, you cannot, because it
depends on the runtime type of <code class="language-plaintext highlighter-rouge">is</code>!”</em></p>
</blockquote>

<p>This is a very good example showing a very frequent booby trap for
beginners that aren’t paying attention to their data structures.</p>

<p>He goes on saying:</p>

<blockquote>
  <p><em>“Choosing a collection is a very deliberate and intentional thing. We
want to select our collection to match the complexity bounds of our
problem. Encouraging (and even enabling!) users to work in terms of
generic types that throw away this information is wrong, and very
very much an anti-pattern.”</em></p>
</blockquote>

<p>I very much respect this opinion and I know from where he’s coming
from, however I disagree with it.</p>

<p>Choosing a collection type means committing to an implementation, it
means specializing, which is a bad idea in many cases. And arguing
against this is also like arguing against Haskell’s
<a href="https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Traversable.html">Traversable</a>
(<a href="https://github.com/typelevel/cats/blob/v1.0.1/core/src/main/scala/cats/Traverse.scala">cats.Traverse</a>).</p>

<p>N.B. we are not arguing against the merits of Haskell’s <code class="language-plaintext highlighter-rouge">Traversable</code>
type class and how that compares with <code class="language-plaintext highlighter-rouge">Iterable</code>. More on that below.</p>

<p class="info-bubble">
<b><u>TL;DR</u></b>: OOP interfaces might expose leaky operations that
are booby traps (e.g. <code class="language-plaintext highlighter-rouge">Seq</code> indexing), but this is not specific
to OOP interfaces, vigilance in design is always needed!
</p>
      <h3 id="24-not-using-type-classes">
        
        
          2.4. Not Using Type-classes <a href="#24-not-using-type-classes" class="anchor">#</a>
        
        
      </h3>
    

<p>This is actually a separate argument that does have merit:</p>

<blockquote>
  <p><em>“
    I'll stick to scalaz's separation of functionality and
    implementation through typeclasses... it's much easier to
    understand, faster, and easier to extend.
  ”</em></p>
  <footer>
    <p>
      <a href="https://twitter.com/fommil/status/962736382467813376" target="_blank">Sam Halliday</a>
    </p>
  </footer>
</blockquote>

<blockquote>
  <p><em>“
   You do not need a top-down hierarchy of collections. They're ready
   to break back compatibility, so why not do it right like Spiewak's
   suggestion 3 years ago? `Builder` and `IterableOnce` are symptoms of a
   deeper problem: poor design choices.    
  ”</em></p>
  <footer>
    <p>
      <a href="https://twitter.com/emi1ypi/status/962743355192020992" target="_blank">Emily Pillmore</a>
    </p>
  </footer>
</blockquote>

<p>The argument for those amongst you not familiar with it is that
type-classes can yield a better design for the standard collections,
instead of an OOP hierarchy of interfaces.</p>

<p>To re-use the example above:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">import</span> <span class="nn">cats.Foldable</span>

<span class="k">def</span> <span class="nf">foo</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span> <span class="kt">:</span> <span class="kt">Foldable</span><span class="o">](</span><span class="n">list</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span> <span class="kt">MyThingy</span> <span class="o">=</span>
  <span class="n">implicitly</span><span class="o">[</span><span class="kt">Foldable</span><span class="o">[</span><span class="kt">F</span><span class="o">]].</span><span class="py">foldLeft</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="k">new</span> <span class="nc">MyThingy</span><span class="o">)(</span><span class="k">_</span> <span class="n">accumulate</span> <span class="k">_</span><span class="o">)</span>
</code></pre></div></div>

<p>Ah, now we are getting somewhere. But the astute reader should notice at this
point that this means exposure of an extra <code class="language-plaintext highlighter-rouge">F[_]</code> type parameter that
you don’t actually need with OOP — well, OK, this syntax heaviness is
an artifact of the Scala language, as in Haskell this wouldn’t be an
issue.</p>

<p>Also, not clearly visible here is that type-classes such as <code class="language-plaintext highlighter-rouge">Foldable</code>
or <code class="language-plaintext highlighter-rouge">Traversable</code>, while more generic are also strictly less capable
than <code class="language-plaintext highlighter-rouge">Iterable</code>. Yes, that’s because of <code class="language-plaintext highlighter-rouge">Iterator</code>’s side effecting,
but highly efficient and flexible protocol. More on that below.</p>

<p class="info-bubble">
<b><u>TL;DR</u></b>: type-classes are nice, playing well with
parametric polymorphism, but in Scala the syntax is heavier than
when using OOP, although this isn’t an issue with Haskell
</p>
      <h2 id="3-oop-vs-constrained-parametric-polymorphism-type-classes">
        
        
          3. OOP vs Constrained Parametric Polymorphism (Type-classes) <a href="#3-oop-vs-constrained-parametric-polymorphism-type-classes" class="anchor">#</a>
        
        
      </h2>
    

<p>Lets imagine a function that sums up numbers:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">import</span> <span class="nn">scala.math.Numeric</span>

<span class="k">def</span> <span class="nf">sum</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">list</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">A</span><span class="o">])(</span><span class="k">implicit</span> <span class="n">A</span><span class="k">:</span> <span class="kt">Numeric</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=</span>
  <span class="nv">list</span><span class="o">.</span><span class="py">foldLeft</span><span class="o">(</span><span class="nv">A</span><span class="o">.</span><span class="py">zero</span><span class="o">)(</span><span class="nv">A</span><span class="o">.</span><span class="py">plus</span><span class="o">)</span>
</code></pre></div></div>

<p>Note we are already using <code class="language-plaintext highlighter-rouge">Numeric</code>, which is a type class exposed by
Scala’s standard library. And it’s actually not the best type class we
could use, as what we’d need here is a
<a href="https://github.com/typelevel/cats/blob/v1.0.1/kernel/src/main/scala/cats/kernel/Monoid.scala">Monoid</a>,
but ignore that.</p>

<p>Meet Haskell’s
<a href="https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Foldable.html">Data.Foldable</a>,
also described in
<a href="https://github.com/typelevel/cats/blob/v1.0.1/core/src/main/scala/cats/Foldable.scala">cats.Foldable</a>.</p>

<p>With it we can fold arbitrary data-structures, e.g. we could sum up numbers:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">import</span> <span class="nn">cats.Foldable</span>
<span class="k">import</span> <span class="nn">scala.math.Numeric</span>

<span class="k">def</span> <span class="nf">sum</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span><span class="n">list</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span>
  <span class="o">(</span><span class="k">implicit</span> <span class="n">F</span><span class="k">:</span> <span class="kt">Foldable</span><span class="o">[</span><span class="kt">F</span><span class="o">],</span> <span class="n">A</span><span class="k">:</span> <span class="kt">Numeric</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=</span> <span class="o">{</span>

  <span class="nv">F</span><span class="o">.</span><span class="py">foldLeft</span><span class="o">(</span><span class="n">list</span><span class="o">,</span> <span class="nv">A</span><span class="o">.</span><span class="py">zero</span><span class="o">)(</span><span class="nv">A</span><span class="o">.</span><span class="py">plus</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>(N.B. using <code class="language-plaintext highlighter-rouge">F</code> and <code class="language-plaintext highlighter-rouge">A</code> as the type names <em>and</em> as the name of the
implicit parameters is nothing special, just a convention)</p>

<p>Is this better?</p>

<ul>
  <li><strong>PRO:</strong> describing <code class="language-plaintext highlighter-rouge">foldLeft</code> as a method on <code class="language-plaintext highlighter-rouge">F[_]</code> is no longer
required, which makes <code class="language-plaintext highlighter-rouge">F[_]</code> data types more generic, more reusable;
not very clear in this case, but if you’re unfamiliar with
type-class based design, trust me on this one</li>
  <li><strong>CON:</strong> this method makes <code class="language-plaintext highlighter-rouge">F[_]</code> clearly visible, exposing it at the
type system level - this is no longer subtyping, this is no longer the
<a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution principle</a>,
this is parametric polymorphism and it moves the dispatch cost at
compile time, with both the good and the bad</li>
</ul>

<p class="info-bubble">
<b><u>TL;DR</u></b>: With Scala you can actually pick and choose the best
approach - this can lead to choice paralysis however and lots of drama!
</p>
      <h3 id="4-case-study-monix-iterant">
        
        
          4. Case Study: Monix Iterant <a href="#4-case-study-monix-iterant" class="anchor">#</a>
        
        
      </h3>
    

<figure>
  <a href="https://www.youtube.com/watch?v=JFbYQGG2Nb4" target="_blank" title="A Tale of Two Monix Streams, by Alexandru Nedelcu">
    <img src="https://img.youtube.com/vi/JFbYQGG2Nb4/maxresdefault.jpg" />
  </a>
</figure>

<p>At <a href="https://scala.world/schedule">Scala World</a> I had a talk titled
<a href="https://www.youtube.com/watch?v=JFbYQGG2Nb4">A Tale of Two Monix Streams</a>
in which I described the design of the upcoming <code class="language-plaintext highlighter-rouge">monix.tail.Iterant</code>.</p>

<p>It’s a wonderful data structure for modelling streams that makes use
of type-classes defined in
<a href="https://github.com/typelevel/cats-effect">cats-effect</a> for being able
to describe asynchronous computations.  In the presentation I describe
how I made use of type-classes, with actual restrictions placed on the
operations themselves.</p>

<p>If you’re a beginner in FP design via type-classes, I highly recommend
the second part of the presentation.</p>

<p>Here’s the gist - suppose we want a pure
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/Iterator.html">Iterator</a>
that is also capable of deferring the evaluation to a given <code class="language-plaintext highlighter-rouge">F[_]</code>
(e.g. <code class="language-plaintext highlighter-rouge">monix.eval.Task</code>, <code class="language-plaintext highlighter-rouge">cats.effect.IO</code>), such that it’s also
capable of streaming events from asynchronous sources, we could
describe it like this:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">]</span>

<span class="nc">case</span> <span class="k">class</span> <span class="nc">Next</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span><span class="n">first</span><span class="k">:</span> <span class="kt">A</span><span class="o">,</span> <span class="n">rest</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]],</span> <span class="n">stop</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Unit</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Suspend</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span><span class="n">rest</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]],</span> <span class="n">stop</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Unit</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Halt</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span><span class="n">error</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Throwable</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">ITerant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span>
</code></pre></div></div>

<p>This is a data structure that resembles <code class="language-plaintext highlighter-rouge">List</code>, but that:</p>

<ol>
  <li>defers evaluation to an <code class="language-plaintext highlighter-rouge">F[_]</code> data type that’s capable of
suspending side effects, but note that the <em>actual type class
restrictions</em> are not defined on the data structure itself</li>
  <li>is capable of asynchronous processing, in case <code class="language-plaintext highlighter-rouge">F[_]</code> is
capable of asynchronous processing (thus also being equivalent to
the async iterators in JavaScript or Ix.NET)</li>
  <li>is lazy, if <code class="language-plaintext highlighter-rouge">F[_]</code> is lazy, thus being equivalent to Scala’s
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/immutable/Stream.html">Stream</a>,
or Java’s
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/stream/package-summary.html">Stream</a></li>
  <li>is able to do resource handling, to close any open connections in
case of interruption (by following <code class="language-plaintext highlighter-rouge">stop</code>), thus making it safer
than plain iterators</li>
</ol>
      <h3 id="41-type-classes-for-super-powers">
        
        
          4.1. Type-classes For Super Powers <a href="#41-type-classes-for-super-powers" class="anchor">#</a>
        
        
      </h3>
    

<p>So how can this simple data structure possibly have such super powers?</p>

<p>The answer is that it defers the hard work to any <code class="language-plaintext highlighter-rouge">F[_]</code> data type
whose capabilities are defined via type classes.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">import</span> <span class="nn">cats.effect.Sync</span>

<span class="k">def</span> <span class="nf">map</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span><span class="n">fa</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">])(</span><span class="n">f</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">B</span><span class="o">)</span>
  <span class="o">(</span><span class="k">implicit</span> <span class="n">F</span><span class="k">:</span> <span class="kt">Sync</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">loop</span><span class="o">(</span><span class="n">current</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span> <span class="k">=</span>
    <span class="n">current</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">Next</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="n">rest</span><span class="o">,</span> <span class="n">stop</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="nc">Next</span><span class="o">(</span><span class="nf">f</span><span class="o">(</span><span class="n">b</span><span class="o">),</span> <span class="nv">rest</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="n">loop</span><span class="o">),</span> <span class="n">stop</span><span class="o">)</span>
      <span class="k">case</span> <span class="nc">Suspend</span><span class="o">(</span><span class="n">rest</span><span class="o">,</span> <span class="n">stop</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="nc">Suspend</span><span class="o">(</span><span class="nv">rest</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="n">loop</span><span class="o">),</span> <span class="n">stop</span><span class="o">)</span>
      <span class="k">case</span> <span class="nc">Halt</span><span class="o">(</span><span class="n">e</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="nc">Halt</span><span class="o">(</span><span class="n">e</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="nf">loop</span><span class="o">(</span><span class="n">fa</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>That part about “<code class="language-plaintext highlighter-rouge">implicit F: Sync[F]</code>”, that’s the restriction we
have for <code class="language-plaintext highlighter-rouge">F[_]</code>, defining its capabilities.</p>

<p>What we need here is for <code class="language-plaintext highlighter-rouge">F[_]</code> to implement a <code class="language-plaintext highlighter-rouge">map</code> operation and
thus it needs to have a
<a href="https://github.com/typelevel/cats/blob/v1.0.1/core/src/main/scala/cats/Functor.scala">Functor</a>
instance, however our <code class="language-plaintext highlighter-rouge">map</code> is used in fact recursively and due to
Scala being a strict language, if this <code class="language-plaintext highlighter-rouge">map</code> were to be strictly
evaluated, then we’d
<a href="https://github.com/typelevel/cats-effect/issues/92">end up with a stack overflow</a>.
This is why we require <code class="language-plaintext highlighter-rouge">cats.effect.Sync</code>, which implies a <code class="language-plaintext highlighter-rouge">Functor</code>,
because <code class="language-plaintext highlighter-rouge">Sync</code> now suspends evaluation in <code class="language-plaintext highlighter-rouge">map</code> by law.</p>

<p>You can see how this process goes: you only add the restrictions you
want on the operations themselves, depending on your needs, not on
the data structure, thus making the data structure more reusable.</p>

<p><strong>IMPORTANT:</strong> <code class="language-plaintext highlighter-rouge">F</code> gets exposed via the type system at compile
time. It’s should be obvious that given <code class="language-plaintext highlighter-rouge">F</code> and <code class="language-plaintext highlighter-rouge">G</code>, then an
<code class="language-plaintext highlighter-rouge">Iterant[F, A]</code> cannot be composed with an <code class="language-plaintext highlighter-rouge">Iterant[G, A]</code>. So an
<code class="language-plaintext highlighter-rouge">Iterant[Task, A]</code> (see
<a href="https://monix.io/docs/2x/eval/task.html">Task</a>) cannot be composed
with an <code class="language-plaintext highlighter-rouge">Iterant[Coeval, A]</code> (see
<a href="https://monix.io/docs/2x/eval/coeval.html">Coeval</a>), or with an
<code class="language-plaintext highlighter-rouge">Iterant[IO, A]</code> (see
<a href="https://github.com/typelevel/cats-effect/blob/v0.8/core/shared/src/main/scala/cats/effect/IO.scala">IO</a>),
unless you convert between these data types explicitly.</p>

<p>For example this should trigger a compile time error:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">val</span> <span class="nv">tasks</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">Task</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">???</span>
<span class="k">val</span> <span class="nv">ios</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">IO</span>, <span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="o">???</span>

<span class="c1">// Nope, can't do this ;-)</span>
<span class="n">tasks</span> <span class="o">++</span> <span class="n">ios</span>
</code></pre></div></div>

<p class="info-bubble">
<b><u>TL;DR</u></b>: constrained parametric polymorphism via type-classes
can give you super powers by effectively outsourcing the processing to
pluggable data types with various capabilities, the restrictions being on
the operations themselves!
</p>
      <h3 id="42-liskov-substitution-principle-oop-strikes-back">
        
        
          4.2. Liskov Substitution Principle: OOP Strikes Back <a href="#42-liskov-substitution-principle-oop-strikes-back" class="anchor">#</a>
        
        
      </h3>
    

<p>That last example should make you think - parametric polymorphism implies:</p>

<ol>
  <li>exposing <code class="language-plaintext highlighter-rouge">F</code> type parameters at compile time</li>
  <li>homogeneity</li>
</ol>

<p>Because on top of Scala we are looking for opportunities to optimize
performance, due to the runtime not being optimized for laziness and
<code class="language-plaintext highlighter-rouge">IO</code> data types (like Haskell), we want to process items in batches,
where possible. For example we’d like to stream arrays, because arrays
are contiguous memory blocks and if you don’t find ways to work with
arrays, then you’re screwed in terms of throughput:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">NextBatch</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span>
  <span class="n">batch</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span>
  <span class="n">rest</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]],</span>
  <span class="n">stop</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Unit</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span>
</code></pre></div></div>

<p>But why only arrays? What if we allowed Scala’s <code class="language-plaintext highlighter-rouge">List</code> or <code class="language-plaintext highlighter-rouge">Vector</code> as
well? There’s no harm in that and it would still have better
throughput, so might as well use Scala’s
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/Seq.html">Seq</a>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">NextBatch</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span>
  <span class="n">batch</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span>
  <span class="n">rest</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]],</span>
  <span class="n">stop</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Unit</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span>
</code></pre></div></div>

<p>But wait, because somebody told us that OOP sucks or that the standard
collections should not have a hierarchy, lets use type parameters, like we
did with <code class="language-plaintext highlighter-rouge">F</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">NextBatch</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">Seq</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span>
  <span class="n">batch</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span>
  <span class="n">rest</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]],</span>
  <span class="n">stop</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Unit</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span>
</code></pre></div></div>

<p>Oh wait, this doesn’t work, unless we’d expose <code class="language-plaintext highlighter-rouge">Seq[_]</code> in <code class="language-plaintext highlighter-rouge">Iterant</code> as well:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">sealed</span> <span class="k">trait</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">Seq</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">]</span>

<span class="nc">case</span> <span class="k">class</span> <span class="nc">NextBatch</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">Seq</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span>
  <span class="n">batch</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span>
  <span class="n">rest</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]],</span>
  <span class="n">stop</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Unit</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">Seq</span>, <span class="kt">A</span><span class="o">]</span>
</code></pre></div></div>

<p>But this sucks, not only due to the types getting more complicated
(your Scala compiler is giving you ugly looks right about now), but
also because you can’t have heterogeneity:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">val</span> <span class="nv">node1</span> <span class="k">=</span> <span class="nc">NextBatch</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">),</span> <span class="nc">IO</span><span class="o">(</span><span class="nc">Halt</span><span class="o">(</span><span class="nc">None</span><span class="o">)),</span> <span class="nv">IO</span><span class="o">.</span><span class="py">unit</span><span class="o">)</span>
<span class="c1">// Ooops, not compatible, List is not Array, will trigger error ;-)</span>
<span class="k">val</span> <span class="nv">node2</span> <span class="k">=</span> <span class="nc">NextBatch</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">),</span> <span class="nc">IO</span><span class="o">(</span><span class="n">node1</span><span class="o">),</span> <span class="nv">IO</span><span class="o">.</span><span class="py">unit</span><span class="o">)</span>
</code></pre></div></div>

<p>No, screw that, let’s backtrack - at this point we need
the type class restriction to be on the data structure itself:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">NextBatch</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">Seq</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span>
  <span class="n">batch</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span>
  <span class="n">rest</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]],</span>
  <span class="n">stop</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Unit</span><span class="o">])</span>
  <span class="o">(</span><span class="k">implicit</span> <span class="nc">Seq</span><span class="k">:</span> <span class="kt">Foldable</span><span class="o">[</span><span class="kt">Seq</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span>
</code></pre></div></div>

<p>That’s better, right?</p>

<p>Wrong - if you’re passing that type-class instance around, that’s
effectively a
<a href="https://en.wikipedia.org/wiki/Virtual_method_table">vtable</a> so
congratulations, you have an OOP encoding with extra garbage.</p>

<p class="info-bubble">
<b><u>TL;DR</u></b>: with constrained parametric polymorphism you
either expose the data type as a type parameter, making types more
complicated and saying goodbye to heterogeneity, or you end up with a
shitty OOP substitute!
</p>
      <h3 id="43-iterator-vs-foldable-and-traverse">
        
        
          4.3. Iterator vs Foldable and Traverse <a href="#43-iterator-vs-foldable-and-traverse" class="anchor">#</a>
        
        
      </h3>
    

<p>Many people are under the impression that you can substitute the classic
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/Iterator.html">Iterator</a>
with the <a href="https://github.com/typelevel/cats/blob/v1.0.1/core/src/main/scala/cats/Foldable.scala">Foldable</a>
and <a href="https://github.com/typelevel/cats/blob/v1.0.1/core/src/main/scala/cats/Traverse.scala">Traverse</a>
type-classes. This is understandable, because these type classes are
really potent, really generic, great actually.</p>

<p>Here’s  Phil Freeman’s opinion, the creator of the PureScript language:</p>

<blockquote>
  <p><em>“
    ES2018 will include a whole new language feature in order to
    implement one instantiation of “traverse”. I’ll say it again - JS
    won’t be fixed by adding more
    things. <a href="http://2ality.com/2017/02/ecmascript-2018.html">2ality.com/2017/02/ecmascript-2018.html</a>
  ”</em></p>
  <footer>
    <p>
      <a href="https://twitter.com/paf31/status/960270750903975936" target="_blank">Source</a>
    </p>
  </footer>
</blockquote>

<p>But that is simply <em>false</em>.</p>

<p>Here’s the big difference: <code class="language-plaintext highlighter-rouge">Iterator</code> allows you to <em>pause</em> the
processing, until the current iteration cycle has finished, before
processing the next item, being a pull-based protocol with the user
being <em>completely in charge</em>. The user being responsible for advancing
the cursor to the next item, whenever he wants, in a destructive
manner is also what makes it error prone, but it’s flexible
nonetheless.</p>

<p>So for example, how do you think this works?</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">val</span> <span class="nv">ios</span><span class="k">:</span> <span class="kt">Iterable</span><span class="o">[</span><span class="kt">IO</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="o">???</span>

<span class="nv">ios</span><span class="o">.</span><span class="py">foldLeft</span><span class="o">(</span><span class="nc">IO</span><span class="o">(</span><span class="mi">0</span><span class="o">))</span> <span class="o">{</span> <span class="o">(</span><span class="n">acc</span><span class="o">,</span> <span class="n">elem</span><span class="o">)</span> <span class="k">=&gt;</span>
  <span class="nf">for</span> <span class="o">(</span><span class="n">a</span> <span class="k">&lt;-</span> <span class="n">acc</span><span class="o">;</span> <span class="n">e</span> <span class="k">&lt;-</span> <span class="n">elem</span><span class="o">)</span> <span class="k">yield</span> <span class="n">a</span> <span class="o">+</span> <span class="n">e</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The short answer - it works, but if that stream is too big, it will
blow up your process because there’s no back-pressure in that fold.
But I digress.</p>

<p>Iterating over arrays in our <code class="language-plaintext highlighter-rouge">NextBatch</code> might prove tricky but is
doable, for example in a <code class="language-plaintext highlighter-rouge">mapEval</code> implementation that needs to pop an
item out of our <code class="language-plaintext highlighter-rouge">Array</code>, process that in the <code class="language-plaintext highlighter-rouge">F[_]</code> monadic context,
then continue from where it left off:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">def</span> <span class="nf">mapEval</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span><span class="n">fa</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">])(</span><span class="n">f</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">F</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span>
  <span class="o">(</span><span class="k">implicit</span> <span class="n">F</span><span class="k">:</span> <span class="kt">Sync</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">loop</span><span class="o">(</span><span class="n">index</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)(</span><span class="n">fa</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
    <span class="n">fa</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">NextBatch</span><span class="o">(</span><span class="n">batch</span><span class="o">,</span> <span class="n">rest</span><span class="o">,</span> <span class="n">stop</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="k">val</span> <span class="nv">eval</span> <span class="k">=</span>
          <span class="nf">if</span> <span class="o">(</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="nv">batch</span><span class="o">.</span><span class="py">length</span><span class="o">)</span>
            <span class="nv">rest</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="nf">loop</span><span class="o">(</span><span class="mi">0</span><span class="o">))</span>
          <span class="k">else</span>
            <span class="nf">f</span><span class="o">(</span><span class="nf">batch</span><span class="o">(</span><span class="n">index</span><span class="o">)).</span><span class="py">map</span> <span class="o">{</span> <span class="n">a</span> <span class="k">=&gt;</span>
              <span class="nc">Next</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="nv">F</span><span class="o">.</span><span class="py">pure</span><span class="o">(</span><span class="nf">loop</span><span class="o">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)(</span><span class="n">fa</span><span class="o">)),</span> <span class="n">stop</span><span class="o">)</span>
            <span class="o">}</span>
        <span class="nc">Suspend</span><span class="o">(</span><span class="n">eval</span><span class="o">,</span> <span class="n">stop</span><span class="o">)</span>

      <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span> <span class="o">???</span>
    <span class="o">}</span>
  <span class="nf">loop</span><span class="o">(</span><span class="mi">0</span><span class="o">)(</span><span class="n">fa</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Well, <code class="language-plaintext highlighter-rouge">Array</code> can be indexed, but that indexing would be death for
<code class="language-plaintext highlighter-rouge">List</code>, isn’t it?</p>

<p>Turns out we have a perfectly capable abstraction for iterating over
arrays, lists, vectors or what have you, the classic
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/Iterator.html">Iterator</a>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">NextCursor</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span>
  <span class="n">cursor</span><span class="k">:</span> <span class="kt">Iterator</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span>
  <span class="n">rest</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]],</span>
  <span class="n">stop</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">Unit</span><span class="o">])</span>
  <span class="k">extends</span> <span class="nc">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">]</span>
</code></pre></div></div>

<p>And now we can express this:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">def</span> <span class="nf">mapEval</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span>, <span class="kt">A</span><span class="o">](</span><span class="n">fa</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">])(</span><span class="n">f</span><span class="k">:</span> <span class="kt">A</span> <span class="o">=&gt;</span> <span class="n">F</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span>
  <span class="o">(</span><span class="k">implicit</span> <span class="n">F</span><span class="k">:</span> <span class="kt">Sync</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">B</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>

  <span class="k">def</span> <span class="nf">loop</span><span class="o">(</span><span class="n">fa</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">Iterant</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
    <span class="n">fa</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">NextBatch</span><span class="o">(</span><span class="n">batch</span><span class="o">,</span> <span class="n">rest</span><span class="o">,</span> <span class="n">stop</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="nf">loop</span><span class="o">(</span><span class="nc">NextCursor</span><span class="o">(</span><span class="nv">batch</span><span class="o">.</span><span class="py">iterator</span><span class="o">(),</span> <span class="n">rest</span><span class="o">,</span> <span class="n">stop</span><span class="o">))</span>
      <span class="k">case</span> <span class="nc">NextCursor</span><span class="o">(</span><span class="n">cursor</span><span class="o">,</span> <span class="n">rest</span><span class="o">,</span> <span class="n">stop</span><span class="o">)</span> <span class="k">=&gt;</span>
        <span class="k">val</span> <span class="nv">eval</span> <span class="k">=</span>
          <span class="nf">if</span> <span class="o">(</span><span class="nv">cursor</span><span class="o">.</span><span class="py">hasNext</span><span class="o">)</span>
            <span class="nv">rest</span><span class="o">.</span><span class="py">map</span><span class="o">(</span><span class="n">loop</span><span class="o">)</span>
          <span class="k">else</span>
            <span class="nf">f</span><span class="o">(</span><span class="nv">batch</span><span class="o">.</span><span class="py">next</span><span class="o">()).</span><span class="py">map</span> <span class="o">{</span> <span class="n">a</span> <span class="k">=&gt;</span>
              <span class="nc">Next</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="nv">F</span><span class="o">.</span><span class="py">pure</span><span class="o">(</span><span class="nf">loop</span><span class="o">(</span><span class="n">fa</span><span class="o">)),</span> <span class="n">stop</span><span class="o">)</span>
            <span class="o">}</span>
        <span class="nc">Suspend</span><span class="o">(</span><span class="n">eval</span><span class="o">,</span> <span class="n">stop</span><span class="o">)</span>
      <span class="k">case</span> <span class="k">_</span> <span class="k">=&gt;</span>
        <span class="o">???</span>
    <span class="o">}</span>
  <span class="c1">// Suspends execution, because NextCursor is side-effectful ;-)</span>
  <span class="nc">Suspend</span><span class="o">(</span><span class="nv">F</span><span class="o">.</span><span class="py">delay</span><span class="o">(</span><span class="nf">loop</span><span class="o">(</span><span class="n">fa</span><span class="o">)),</span> <span class="nv">F</span><span class="o">.</span><span class="py">unit</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Can you do that with <code class="language-plaintext highlighter-rouge">Foldable</code> / <code class="language-plaintext highlighter-rouge">Traverse</code>? No, you can’t!</p>

<p class="info-bubble">
If a tree falls in a forest and no one is around to hear it, is that a
<a href="https://en.wikipedia.org/wiki/Side_effect_(computer_science)"><i>side effect</i></a>?
<br /><br />
The <code class="language-plaintext highlighter-rouge">Iterator</code> interface relies on side effects and is thus
incompatible with functional programming. However if its mutation is
properly suspended and encapsulated, such that <i>referential
transparency</i> is preserved, then it really doesn’t matter 😉
</p>

<p>To work with type-classes and pure functions, our first intuition
should be something like this:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">trait</span> <span class="nc">IteratorTypeClass</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="nf">next</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">fa</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[(</span><span class="kt">A</span>, <span class="kt">F</span><span class="o">[</span><span class="kt">A</span><span class="o">])]</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This is a variation on the
<a href="https://wiki.haskell.org/State_Monad">state monad</a>, because yes,
we’ve got state to evolve.</p>

<p>Here’s the performance characteristics of such a decomposition
for the <code class="language-plaintext highlighter-rouge">head</code> and <code class="language-plaintext highlighter-rouge">tail</code> operations, needed for this type
class:</p>

<ul>
  <li><a href="http://www.scala-lang.org/api/2.12.4/scala/collection/immutable/Vector.html">Vector</a>,
has “<em>effectively constant time</em>”, which is worse than <code class="language-plaintext highlighter-rouge">List</code></li>
  <li><a href="http://www.scala-lang.org/api/2.12.4/scala/collection/immutable/Queue.html">Queue</a>
has “<em>amortized constant time</em>”, which is worse than <code class="language-plaintext highlighter-rouge">List</code></li>
  <li><a href="http://www.scala-lang.org/api/2.12.4/scala/Array.html">Array</a>
has linear O(N) time for <code class="language-plaintext highlighter-rouge">tail</code>, aka you can change your job now</li>
</ul>

<p>Yes, <code class="language-plaintext highlighter-rouge">Iterator</code> is efficient for all of them, so it wins by a wide
margin. The above is actually horrible and why a type class like
that isn’t popular, because it relies on <code class="language-plaintext highlighter-rouge">List</code>’s encoding to be
efficient 😉</p>

<p>So that’s not it. The pure type-class equivalent is actually this:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="k">trait</span> <span class="nc">IteratorTypeClass</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]]</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">Pointer</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span>

  <span class="k">def</span> <span class="nf">start</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">fa</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">Pointer</span><span class="o">[</span><span class="kt">A</span><span class="o">]</span>
  <span class="k">def</span> <span class="nf">next</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">fa</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> <span class="n">cursor</span><span class="k">:</span> <span class="kt">Pointer</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[(</span><span class="kt">A</span>, <span class="kt">Pointer</span><span class="o">[</span><span class="kt">A</span><span class="o">])]</span>
<span class="o">}</span>

<span class="c1">// Sample instance for Array</span>
<span class="k">object</span> <span class="nc">ArrayIterator</span> <span class="k">extends</span> <span class="nc">IteratorTypeClass</span><span class="o">[</span><span class="kt">Array</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">type</span> <span class="kt">Pointer</span><span class="o">[</span><span class="kt">T</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Int</span>

  <span class="k">def</span> <span class="nf">start</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">fa</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">A</span><span class="o">])</span> <span class="k">=</span> <span class="mi">0</span>
  <span class="k">def</span> <span class="nf">next</span><span class="o">[</span><span class="kt">A</span><span class="o">](</span><span class="n">fa</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">A</span><span class="o">],</span> <span class="n">cursor</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span>
    <span class="nf">if</span> <span class="o">(</span><span class="n">cursor</span> <span class="o">&gt;=</span> <span class="nv">fa</span><span class="o">.</span><span class="py">length</span><span class="o">)</span> <span class="nc">None</span>
    <span class="k">else</span> <span class="nc">Some</span><span class="o">((</span><span class="nf">fa</span><span class="o">(</span><span class="n">cursor</span><span class="o">),</span> <span class="n">cursor</span> <span class="o">+</span> <span class="mi">1</span><span class="o">))</span>
<span class="o">}</span>
</code></pre></div></div>

<p>But this will leak implementation details - not bad for our <code class="language-plaintext highlighter-rouge">Array</code>
instance, but what if we had some sort of
<a href="https://en.wikipedia.org/wiki/Self-balancing_binary_search_tree">self-balancing tree</a>
which you then changed to a
<a href="https://en.wikipedia.org/wiki/Hash_array_mapped_trie">HAMT</a>.
In that case our <code class="language-plaintext highlighter-rouge">Pointer</code> would be some sort of node with links
to its neighbors, so is it wise exposing it like that? How
is Haskell’s binary compatibility anyway? Does it even support
dynamic linking?</p>

<p class="info-bubble">
<b><u>TL;DR</u></b>: <code class="language-plaintext highlighter-rouge">Iterator</code> actually beats pure, type-class
based solution in performance, flexibility or encapsulation! It’s
also lower-level, impure and error prone, but sorely needed sometimes.
</p>
      <h2 id="5-seq-my-love">
        
        
          5. Seq My Love <a href="#5-seq-my-love" class="anchor">#</a>
        
        
      </h2>
    

<p>I actually like
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/Seq.html">Seq</a>
and have never regretted using it.</p>

<p>Not everybody agrees and as mentioned in section
<a href="#23-seq-or-other-super-types">2.3.</a>, there are people advising against its usage:</p>

<blockquote>
  <p><em>“
    You always care about the asymptotic properties of your data
    structures. So there is never a case where Seq makes sense, even as
    a concept!
  ”</em></p>
  <footer>
    <p>
      <a href="https://twitter.com/djspiewak/status/962767948774457344">Daniel Spiewak</a>
    </p>
  </footer>
</blockquote>

<p>Here’s why I disagree …</p>
      <h3 id="51-seq-on-return">
        
        
          5.1. Seq on Return <a href="#51-seq-on-return" class="anchor">#</a>
        
        
      </h3>
    

<p>Returning <code class="language-plaintext highlighter-rouge">Seq</code> from a function gives you the freedom to change the
implementation and this works well because:</p>

<ol>
  <li>you preserve backwards binary compatibility</li>
  <li>users might only care to traverse it / fold it, which should be an
O(n) operation for any sequence</li>
</ol>

<p>Real use-case from Monix, the
<a href="https://github.com/monix/monix/blob/v3.0.0-M3/monix-reactive/shared/src/main/scala/monix/reactive/Observable.scala#L372">Observable.bufferSliding</a>
operator:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="cm">/** Returns an observable that emits buffers of items it collects from
  * the source observable. The resulting observable emits buffers
  * every `skip` items, each containing `count` items.
  *
  * If the source observable completes, then the current buffer gets
  * signaled downstream. If the source triggers an error then the
  * current buffer is being dropped and the error gets propagated
  * immediately.
  *
  * For `count` and `skip` there are 3 possibilities:
  *
  *  1. in case `skip == count`, then there are no items dropped and
  *     no overlap, the call being equivalent to `buffer(count)`
  *  1. in case `skip &lt; count`, then overlap between buffers
  *     happens, with the number of elements being repeated being
  *     `count - skip`
  *  1. in case `skip &gt; count`, then `skip - count` elements start
  *     getting dropped between windows
  *
  * @param count the maximum size of each buffer before it should
  *        be emitted
  * @param skip how many items emitted by the source observable should
  *        be skipped before starting a new buffer. Note that when
  *        skip and count are equal, this is the same operation as
  *        `buffer(count)`
  */</span>
<span class="k">final</span> <span class="k">def</span> <span class="nf">bufferSliding</span><span class="o">(</span><span class="n">count</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">skip</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Observable</span><span class="o">[</span><span class="kt">Seq</span><span class="o">[</span><span class="kt">A</span><span class="o">]]</span> <span class="k">=</span>
  <span class="nf">liftByOperator</span><span class="o">(</span><span class="k">new</span> <span class="nc">BufferSlidingOperator</span><span class="o">(</span><span class="n">count</span><span class="o">,</span> <span class="n">skip</span><span class="o">))</span>
</code></pre></div></div>

<p>Facts:</p>

<ul>
  <li><a href="https://github.com/monix/monix/blob/v3.0.0-M1/monix-reactive/shared/src/main/scala/monix/reactive/internal/operators/BufferSlidingOperator.scala#L43">current version (3.0.0-M3)</a>
uses an <a href="https://www.scala-lang.org/api/2.12.4/scala/Array.html">Array</a>
as the internal buffer, emitting arrays
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/mutable/WrappedArray.html">wrapped in Seq</a></li>
  <li><a href="https://github.com/monix/monix/blob/v2.0.0/monix-reactive/shared/src/main/scala/monix/reactive/internal/operators/BufferSlidingOperator.scala#L41">version 2.0.0</a>
used a <a href="https://www.scala-lang.org/api/2.12.4/scala/collection/mutable/ListBuffer.html">ListBuffer</a>,
thus emitting <code class="language-plaintext highlighter-rouge">List</code> chunks</li>
</ul>

<p>The change from <code class="language-plaintext highlighter-rouge">List</code> to <code class="language-plaintext highlighter-rouge">Array</code> was done:</p>

<ul>
  <li>without breaking backwards compatibility</li>
  <li>with no consequence to the user, since these chunks are meant to be
<i>small and manageable</i>, so all the user cares about is being
able to traverse or fold them or to convert them into something else</li>
</ul>

<p>This is the infamous “<em>program to an interface, not to an implementation</em>”
mantra that OOP developers like to repeat so much. You won’t
actually need this capability that often, but when you do, it’s golden.</p>

<p>Also note that when using a super-type such as <code class="language-plaintext highlighter-rouge">Seq</code> in an interface, due to the
<a href="https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)">covariance</a>
of return types, you’re always allowed to override with a more
specific type in implementing classes (e.g.  to go from <code class="language-plaintext highlighter-rouge">Seq</code> to
<code class="language-plaintext highlighter-rouge">List</code>), and the Liskov substitution principle still applies.</p>

<p class="info-bubble">
<b><u>TL;DR</u></b>: there are perfectly valid use-cases for <code class="language-plaintext highlighter-rouge">Seq</code> as the return type!
</p>
      <h3 id="52-seq-on-input">
        
        
          5.2. Seq on Input <a href="#52-seq-on-input" class="anchor">#</a>
        
        
      </h3>
    

<p>The necessity for <code class="language-plaintext highlighter-rouge">Seq</code> is the same as for
<a href="https://github.com/typelevel/cats/blob/v1.0.1/core/src/main/scala/cats/Foldable.scala">Foldable</a>,
the need to traverse a collection, aggregating its items into some final result.</p>

<p><code class="language-plaintext highlighter-rouge">Seq</code> also implies that items come in a
<a href="https://en.wikipedia.org/wiki/Sequence">sequence</a> in which order
matters and repetition is allowed. For example a
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/immutable/Set.html">Set</a>
shouldn’t be a <code class="language-plaintext highlighter-rouge">Seq</code>, because <code class="language-plaintext highlighter-rouge">Set</code> does not allow repetition and has
no ordering.</p>

<p>So here’s another real-world use-case, also from Monix, the
<a href="https://github.com/monix/monix/blob/v3.0.0-M3/monix-reactive/shared/src/main/scala/monix/reactive/Observable.scala#L2148">Observable.startWith</a>
operator:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="code"><code><span class="cm">/** Creates a new Observable that emits the given elements and then
  * it also emits the events of the source (prepend operation).
  */</span>
<span class="k">final</span> <span class="k">def</span> <span class="nf">startWith</span><span class="o">[</span><span class="kt">B</span> <span class="k">&gt;:</span> <span class="kt">A</span><span class="o">](</span><span class="n">elems</span><span class="k">:</span> <span class="kt">Seq</span><span class="o">[</span><span class="kt">B</span><span class="o">])</span><span class="k">:</span> <span class="kt">Observable</span><span class="o">[</span><span class="kt">B</span><span class="o">]</span> <span class="k">=</span>
  <span class="nv">Observable</span><span class="o">.</span><span class="py">fromIterable</span><span class="o">(</span><span class="n">elems</span><span class="o">)</span> <span class="o">++</span> <span class="n">self</span>
</code></pre></div></div>

<p>Here we might have used an
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/Iterator.html">Iterator</a>,
however the result wouldn’t have been pure and we might have used an
<a href="https://www.scala-lang.org/api/2.12.4/scala/collection/Iterable.html">Iterable</a>,
but as the author of this operator I felt that the input being a sequence
is important for getting back a predictable result - after all, that ordering
is important is implied by what this operator does.</p>

<p>And note that all the implementation does is to care about traversal, via
an <code class="language-plaintext highlighter-rouge">Iterator</code> loop.</p>

<p class="info-bubble">
<b><u>TL;DR</u></b>: yes, there are perfectly valid use-cases for <code class="language-plaintext highlighter-rouge">Seq</code> as the input!
</p>
      <h2 id="6-conclusion">
        
        
          6. Conclusion <a href="#6-conclusion" class="anchor">#</a>
        
        
      </h2>
    

<p>Here’s a summary:</p>

<ul>
  <li><a href="#21-canbuildfrom">2.1.</a> — <code class="language-plaintext highlighter-rouge">CanBuildFrom</code> was a clever solution to an
exagerated problem, but you’ll no longer have to worry about
it</li>
  <li><a href="#22-complex-hierarchy">2.2.</a> — a complex OOP hierarchy, as clever as it may be,
brings with it complexity beyond reason and is counter-productive
for subtype polymorphism</li>
  <li><a href="#23-seq-or-other-super-types">2.3.</a> — OOP interfaces might expose leaky operations that are
booby traps (e.g. <code class="language-plaintext highlighter-rouge">Seq</code> indexing), but this is not specific to OOP
interfaces, vigilance in design is always needed</li>
  <li><a href="#24-not-using-type-classes">2.4.</a> — type-classes are nice, playing well with
parametric polymorphism, but in Scala the syntax is heavier than
when using OOP, although this isn’t an issue with Haskell</li>
  <li><a href="#3-oop-vs-constrained-parametric-polymorphism-type-classes">3.</a> with Scala you can actually pick and choose the best
approach - this can lead to choice paralysis however and lots of
drama</li>
  <li><a href="#41-type-classes-for-super-powers">4.1.</a> — constrained parametric polymorphism via type-classes
can give you super powers by effectively outsourcing the processing
to pluggable data types with various capabilities, the restrictions
being on the operations themselves</li>
  <li><a href="#42-liskov-substitution-principle-oop-strikes-back">4.2.</a> — with constrained parametric polymorphism you either
expose the data type as a type parameter, making types more
complicated and saying goodbye to heterogeneity, or you end up with
a shitty OOP substitute</li>
  <li><a href="#43-iterator-vs-foldable-and-traverse">4.3.</a> — <code class="language-plaintext highlighter-rouge">Iterator</code> actually beats pure, type-class based
solution in performance, flexibility or encapsulation. It’s also
lower-level, impure and error prone, but sorely needed sometimes</li>
  <li><a href="#51-seq-on-return">5.1.</a> — there are perfectly valid use-cases for <code class="language-plaintext highlighter-rouge">Seq</code> as
the return type</li>
  <li><a href="#52-seq-on-input">5.2.</a> — there are perfectly valid use-cases for <code class="language-plaintext highlighter-rouge">Seq</code> as
the input</li>
</ul>

<p>So yes, there will be people out there, such as myself, genuinely enjoying
Scala’s OOP and the new collections.</p>

<p>Thanks for reading ️❤️</p>

  </div>

  <div id="article-details">
    
    <time itemprop="dateModified" content="2018-02-12T00:00:00+0000">
        Published: February 12, 2018
    </time>
    
      | Written by <a href="https://alexn.org/about/#alexelcu" itemprop="url" rel="author">Alexandru Nedelcu</a>
    

    <div id="all-categories">
      Tags:
      
        
        <a href="/blog/tag/best%20of/" class="category">Best Of</a>
      
         | 
        <a href="/blog/tag/oop/" class="category">OOP</a>
      
         | 
        <a href="/blog/tag/fp/" class="category">FP</a>
      
         | 
        <a href="/blog/tag/haskell/" class="category">Haskell</a>
      
         | 
        <a href="/blog/tag/scala/" class="category">Scala</a>
      
    </div>
  </div>

  
  <div class="related">
      <h2 id="related-articles">
        
        
          Related Articles <a href="#related-articles" class="anchor">#</a>
        
        
      </h2>
    
    <div class="container">
      
      
      <div class="item">
        <a class="related-link" href="/blog/2018/05/06/bifunctor-io/">
          On Bifunctor IO and Java&#39;s Checked Exceptions
        </a>
        <div class="related-meta">
          <div class="tags">
            
            
              <a href="/blog/tag/best%20of" class="tag">Best Of</a>
            
               | <a href="/blog/tag/fp" class="tag">FP</a>
            
               | <a href="/blog/tag/haskell" class="tag">Haskell</a>
            
               | <a href="/blog/tag/oop" class="tag">OOP</a>
            
               | <a href="/blog/tag/scala" class="tag">Scala</a>
            
               | <a href="/blog/tag/typelevel" class="tag">Typelevel</a>
                        
          </div>
          <time>May 6, 2018</time>
        </div>
        <div class="clearfix"></div>
      </div>
      
      
      
      <div class="item">
        <a class="related-link" href="/blog/2017/10/15/functional-programming/">
          What is Functional Programming?
        </a>
        <div class="related-meta">
          <div class="tags">
            
            
              <a href="/blog/tag/best%20of" class="tag">Best Of</a>
            
               | <a href="/blog/tag/fp" class="tag">FP</a>
            
               | <a href="/blog/tag/haskell" class="tag">Haskell</a>
            
               | <a href="/blog/tag/scala" class="tag">Scala</a>
            
               | <a href="/blog/tag/javascript" class="tag">JavaScript</a>
                        
          </div>
          <time>October 15, 2017</time>
        </div>
        <div class="clearfix"></div>
      </div>
      
      
      
      <div class="item">
        <a class="related-link" href="/blog/2022/05/13/oop-vs-type-classes-part-1-ideology/">
          OOP vs Type Classes, Part 1: Ideology
        </a>
        <div class="related-meta">
          <div class="tags">
            
            
              <a href="/blog/tag/oop" class="tag">OOP</a>
            
               | <a href="/blog/tag/fp" class="tag">FP</a>
            
               | <a href="/blog/tag/scala" class="tag">Scala</a>
                        
          </div>
          <time>May 13, 2022</time>
        </div>
        <div class="clearfix"></div>
      </div>
      
      
      <div class="clearfix"></div>
    </div>
  </div>
  

  
</article>

      </div>
   </div><!-- end .content -->

   <script async src="/assets/js/modernizr.custom.15390.js?202209131235" type="text/javascript"></script>
<script async src="/assets/js-managed/jquery/dist/jquery.slim.min.js?202209131235" type="text/javascript"></script>
<script async src="/assets/js/dropcap.min.js?202209131235" type="text/javascript"></script>
<script async src="/assets/js/responsive-nav.min.js?202209131235" type="text/javascript"></script>

<script async src="/assets/js/scripts.js?202209131235" type="text/javascript"></script>


<script type="text/javascript">
  (function () {
    var h = "hostname" in document.location && document.location.hostname || "";
    if (h != "" && h.indexOf("alexn.org") == -1) {
      return
    }
    var p = (function () {
      var query = window.location.search.substring(1);
      var vars = query.split('&');
      var p = {};
      for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        p[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
      }
      return p;
    })();

    var now = new Date();
    var url = "https://ly.alexn.org/m.php?idsite=1&rec=1&action_name=In+Defense+of+OOFP&url=https%3A%2F%2Falexn.org%2Fblog%2F2018%2F02%2F12%2Fin-defense-oofp%2F" + 
      "&rand=" + encodeURIComponent(Math.floor(Math.random() * Number.MAX_SAFE_INTEGER)) +
      "&h=" + now.getHours() +
      "&m=" + now.getMinutes() +
      "&s=" + now.getSeconds();

    if ("pk_campaign" in p)
      url += "&_rcn=" + encodeURIComponent(p["pk_campaign"]);
    if ("pk_kwd" in p)
      url += "&_rck=" + encodeURIComponent(p["pk_kwd"]);
    if ("referrer" in document && document.referrer) 
      url += "&urlref=" + encodeURIComponent(document.referrer);
    if ("screen" in window) 
      url += "&res=" + screen.width + "x" + screen.height;

    var d=document, i=d.createElement("img"),s0=d.getElementsByTagName("script"),s=s0[s0.length-1];
    i.setAttribute("alt", "");
    i.setAttribute("referrerpolicy", "no-referrer-when-downgrade");
    i.setAttribute("src", url);
    i.setAttribute("width", "1");
    i.setAttribute("height", "1");
    i.setAttribute("style", "position: fixed !important; bottom: -1px !important; right: -1px !important; border:none !important; margin:0px !important;");
    s.parentNode.insertBefore(i,s);
  })();
</script>
<noscript>
  <img referrerpolicy="no-referrer-when-downgrade" src="https://ly.alexn.org/m.php?idsite=1&rec=1&action_name=In+Defense+of+OOFP&url=https%3A%2F%2Falexn.org%2Fblog%2F2018%2F02%2F12%2Fin-defense-oofp%2F" width="1" height="1" style="position: fixed !important; bottom: -1px !important; right: -1px !important; border:none !important; margin:0px !important;" alt="" />
</noscript>

   <div class="footer">
  
  <div class="container">
    <div class="contributions">
      <div id="footer-comments-widget">
  <h2 id="comments">
  Comments
  <a href="#comments" class="anchor">#</a>
</h2>

<p class="only-js">
  Want to chat in private? Email me: 
  <script id="email-script">
    (function () {
      var lhs = "contact22+comments";
      var rhs = "alexn.org";
      var d = document;
      var a = d.createElement("a");
      a.setAttribute("target", "_blank");
      a.setAttribute("href", "mailto:" + lhs + "@" + rhs + "?subject=Comment%20on%3A%20In%20Defense%20of%20OOFP");
      a.text = lhs + "@" + rhs;
      var es = d.getElementById("email-script");
      es.parentNode.insertBefore(a, es);
    })();
  </script>
</p>


<div id="comments">
  <script data-isso="https://alexn.org/comments/alexn/"
          data-isso-css="false"
          data-isso-lang="en"
          data-isso-reply-to-self="true"
          data-isso-require-author="true"
          data-isso-require-email="false"
          data-isso-reply-notifications="true"
          data-isso-max-comments-top="30"
          data-isso-max-comments-nested="20"
          data-isso-reveal-on-click="20"
          data-isso-gravatar="true"
          data-isso-avatar="false"
          data-isso-vote="false"
          data-vote-levels=""
          src="https://alexn.org/comments/alexn/js/embed.min.js"></script>
  <section id="isso-thread" data-title="In Defense of OOFP">
  </section>
</div>
<noscript>
  <div class="note-warning">
    <strong>Enable JavaScript to see the email address or the public comments!</strong>
    <br>
    <span class="extra">
      Commenting widget is powered by a self-hosted commenting server.
      <span style="white-space: nowrap;">
        Read the <a href="/docs/privacy-policy/">privacy policy</a>.
      </span>
    </span>
  </div>
</noscript>

</div>

<h2 id="contribute">
  Contribute
  <a href="#contribute" class="anchor">#</a>
</h2>

<p>
  Fix or add to this article by submitting a pull request:<br/>
  <a style="white-space: nowrap;" href="https://github.com/alexandru/alexn.org/blob/main/_posts/2018-02-12-in-defense-oofp.md" target="_blank">Edit Page on GitHub</a>
</p>

<p>
  Donate to cover ongoing website costs, or buy me coffee ☕️😋 <br/>
  <a href="https://www.patreon.com/bePatron?u=6102596" target="_blank" class="patreon-button">
    <img label="Become a Patron!" alt="Become a Patron!" title="Become a Patron!" src="/assets/media/buttons/patreon.png" />
  </a>
</p>


<h2 id="subscribe">
  Subscribe
  <a href="#subscribe" class="anchor">#</a>
</h2>

<!-- Begin Mailchimp Signup Form -->
<div id="mc_embed_signup">
  <form action="https://alexn.us4.list-manage.com/subscribe/post?u=5bffa2af025192a58345bd5dc&amp;id=1c9005b255"
    method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank"
    novalidate>
    <div id="mc_embed_signup_scroll">
      <div class="mc-field-group field">
        <label for="mce-EMAIL">Email Address <sup class="asterisk">*</sup></label>
        <input type="email" value="" name="EMAIL" class="required email full-width" id="mce-EMAIL" placeholder="user@domain.com" required>
      </div>
      <!-- <div class="mc-field-group field">
        <label for="mce-FULLNAME">Name</label>
        <input type="text" value="" name="FULLNAME" class="full-width" id="mce-FULLNAME" placeholder="John Doe">
      </div> -->
      <div id="mce-responses" class="clear">
        <div class="response" id="mce-error-response" style="display:none"></div>
        <div class="response" id="mce-success-response" style="display:none"></div>
      </div>
      <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
      <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text"
          name="b_5bffa2af025192a58345bd5dc_1c9005b255" tabindex="-1" value=""></div>
      <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"
          class="button"></div>
    </div>
  </form>
</div>

<div class="note-warning">
  <span class="extra">
    Newsletter subscription uses Mailchimp, see <a href="/docs/privacy-policy/">privacy policy</a>.
    If you're not seeing the form, it may be blocked by the browser; <a target="_blank" href="http://eepurl.com/g5ClAT"><em><span style="white-space: nowrap;">try the external subscribe page &#10141;</span></em></a>
  </span>
</div>


    </div>  
  </div>
  

  <div class="bottom">
    <div class="container">
      <span class="copy">
          &copy; 2009-2022
      </span>
      <span class="links">
        <a href="/docs/license/">License</a> |
        <a href="/docs/privacy-policy/">Privacy Policy</a> |
        <a href="/about/#contact">Contact</a>
      </span>
    </div>
  </div>
</div><!-- end .footer -->

</body>
</html>
