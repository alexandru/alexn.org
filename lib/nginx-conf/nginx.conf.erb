server {
    listen 80;
    server_name  alexn.org *.alexn.org bionicspirit.com;

    location / {
        rewrite  ^/(.*)$  https://www.bionicspirit.com/$1  permanent;
    }
}

server {
    listen 80 default_server;
    listen 443 default_server;

    server_name www.bionicspirit.com;
    charset utf-8;

    ssl on;
    ssl_session_cache   shared:SSL:30m;
    ssl_session_timeout 20m;
    ssl_prefer_server_ciphers on;
    ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv3:+EXP:!kEDH;    
    ssl_protocols SSLv3 TLSv1;

    ssl_certificate_key /etc/ssl/certs/bionicspirit.com.key;
    ssl_certificate /etc/ssl/private/bionicspirit.com-bundle.pem;

    location / {
        root   <%= ENV["BIONICSPIRIT_ROOT"] %>/build/html;
        index  index.html index.htm;
	log_not_found off;

        rewrite  ^/rss/?$  https://feeds.feedburner.com/bionicspirit redirect;
        rewrite ^/docs/dialer.html$ /blog/2009/02/20/tips-for-creating-voip-dialer.html permanent;
        rewrite  ^/TheBuzzEngine/?$  /projects/TheBuzzEngine/ permanent;
        rewrite  ^/crossdomain-requests-js/?$  /projects/crossdomain-requests-js/ permanent;
        rewrite  ^/ro.rss/?$  /rss permanent;

        expires 24h;
    }

    location /assets/ {
        root <%= ENV["BIONICSPIRIT_ROOT"] %>/build/html;
	expires max;
     	log_not_found off;
    }

    error_page  404  /pages/404.html;
}
